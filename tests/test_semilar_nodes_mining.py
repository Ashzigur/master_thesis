'''
Created on Dec 29, 2015

@author: Ivan Ivanov
'''

from ivanov.graph.algorithms.similar_nodes_mining import feature_extraction,\
    fingerprint, shingle_extraction
from ivanov.graph.algorithms.similar_nodes_mining.min_hash_function import MinHashFunction
from ivanov.graph.algorithms.similar_nodes_mining.sketch_matrix import SketchMatrix
from ivanov.graph.algorithms import similar_nodes_mining
from ivanov.graph.hypergraph import Hypergraph
from ivanov.graph import algorithms
import networkx as nx
import numpy as np
import unittest

class TestSimilarNodesMining(unittest.TestCase):
    dummy_graph = nx.MultiDiGraph()
    dummy_graph.add_node(1, labels = ["1"])
    dummy_graph.add_node(2, labels = ["2"])
    dummy_graph.add_node(3, labels = ["3"])
    dummy_graph.add_node(4, labels = ["4"])
    dummy_graph.add_node(5, labels = ["5"])
    dummy_graph.add_node(6, labels = ["6"])
    dummy_graph.add_node(7, labels = ["7"])
    dummy_graph.add_node(8, labels = ["8"])
    dummy_graph.add_node(9, labels = ["9"])
    dummy_graph.add_node(10, labels = ["10"])
    dummy_graph.add_node(11, labels = ["11"])
    dummy_graph.add_node(12, labels = ["12"])
    dummy_graph.add_node(13, labels = ["13"])
    dummy_graph.add_node(14, labels = ["14"])
    dummy_graph.add_node(15, labels = ["15"])
    dummy_graph.add_node(16, labels = ["16"])
    dummy_graph.add_edge(1, 2, label = "0")
    dummy_graph.add_edge(1, 3, label = "0")
    dummy_graph.add_edge(1, 5, label = "0")
    dummy_graph.add_edge(1, 6, label = "0")
    dummy_graph.add_edge(1, 7, label = "0")
    dummy_graph.add_edge(1, 9, label = "0")
    dummy_graph.add_edge(1, 14, label = "0")
    dummy_graph.add_edge(1, 15, label = "0")
    dummy_graph.add_edge(1, 16, label = "0")
    dummy_graph.add_edge(2, 12, label = "0")
    dummy_graph.add_edge(2, 13, label = "0")
    dummy_graph.add_edge(3, 4, label = "0")
    dummy_graph.add_edge(3, 10, label = "0")
    dummy_graph.add_edge(3, 11, label = "0")
    dummy_graph.add_edge(3, 12, label = "0")
    dummy_graph.add_edge(4, 7, label = "0")
    dummy_graph.add_edge(4, 8, label = "0")
    dummy_graph.add_edge(5, 6, label = "0")
    dummy_graph.add_edge(5, 7, label = "0")
    dummy_graph.add_edge(5, 9, label = "0")
    dummy_graph.add_edge(5, 16, label = "0")
    dummy_graph.add_edge(6, 10, label = "0")
    dummy_graph.add_edge(6, 16, label = "0")
    dummy_graph.add_edge(7, 8, label = "0")
    dummy_graph.add_edge(8, 9, label = "0")
    dummy_graph.add_edge(10, 11, label = "0")
    dummy_graph.add_edge(11, 12, label = "0")
    dummy_graph.add_edge(11, 13, label = "0")
    dummy_graph.add_edge(12, 14, label = "0")
    dummy_graph.add_edge(12, 15, label = "0")
    dummy_graph.add_edge(13, 14, label = "0")
    dummy_graph.add_edge(13, 15, label = "0")
    
    dummy_graph_features = []
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["7"])
    dummy_graph_features[-1].add_node("n_8", labels=["8"])
    dummy_graph_features[-1].add_edge("n_7", "n_8", label="0")
    
#     dummy_graph_features.append(nx.MultiDiGraph())
#     dummy_graph_features[-1].add_node("n_7", labels=["1"])
#     dummy_graph_features[-1].add_node("n_8", labels=["2"])
#     dummy_graph_features[-1].add_edge("n_7", "n_8", label="0")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["7"])
    dummy_graph_features[-1].add_node("n_4", labels=["4"])
    dummy_graph_features[-1].add_edge("n_4", "n_7", label="0")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["7"])
    dummy_graph_features[-1].add_node("n_5", labels=["5"])
    dummy_graph_features[-1].add_edge("n_5", "n_7", label="0")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["7"])
    dummy_graph_features[-1].add_node("n_1", labels=["1"])
    dummy_graph_features[-1].add_edge("n_1", "n_7", label="0")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["wl_12"])
    dummy_graph_features[-1].add_node("n_4", labels=["wl_14"])
    dummy_graph_features[-1].add_edge("n_4", "n_7", label="wl_10")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["wl_12"])
    dummy_graph_features[-1].add_node("n_5", labels=["wl_15"])
    dummy_graph_features[-1].add_edge("n_5", "n_7", label="wl_11")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["wl_12"])
    dummy_graph_features[-1].add_node("n_1", labels=["wl_13"])
    dummy_graph_features[-1].add_edge("n_1", "n_7", label="wl_9")
    
    dummy_feature = nx.MultiDiGraph()
    dummy_feature.add_node("n_1", labels=["1", "2"])
    dummy_feature.add_node("n_2", labels=["3"])
    dummy_feature.add_node("n_3", labels=["4", "5", "6"])
    dummy_feature.add_edge("n_1", "n_2", label="7")
    dummy_feature.add_edge("n_3", "n_1", label="7")
    
    hash_functions_params = [{'a': 993574666356312280, 'b': 2730292699127683073}, {'a': 17902435615067968129L, 'b': 11650131884286024407L}, {'a': 9044849789609577133, 'b': 724056870380320329}, {'a': 150495597833670800, 'b': 16505954064658130649L}, {'a': 12105041367393551936L, 'b': 1150346655022162840}, {'a': 10829475974097362633L, 'b': 9153743094554957205}, {'a': 5371693517637735676, 'b': 2244018309903381299}, {'a': 12082685780530009562L, 'b': 17825075431493514879L}, {'a': 88773730355642207, 'b': 7840775997578767334}, {'a': 9761269718701208407L, 'b': 10238379417831954055L}, {'a': 11400091181049917873L, 'b': 16059578451733091018L}, {'a': 8957924485660023832, 'b': 1384449670913558080}, {'a': 1734333976174506691, 'b': 7007506693567303453}, {'a': 6282433863847579864, 'b': 3275319080396970817}, {'a': 12908265320540677863L, 'b': 13208679514669799102L}, {'a': 17888535894006444587L, 'b': 9258262771045747179L}, {'a': 7975203460043457690, 'b': 14992521968846209617L}, {'a': 8201623186251551224, 'b': 7705033276450661985}, {'a': 15466982910889551555L, 'b': 9433665244910435331L}, {'a': 3475059519763288790, 'b': 3079735646727962536}, {'a': 8343164766735088594, 'b': 13694965633093924261L}, {'a': 16361358965428914495L, 'b': 17026324821536699030L}, {'a': 11598111564251383576L, 'b': 9123682438726006510}, {'a': 18420734015078841043L, 'b': 5494895542220966398}, {'a': 9217194867963728579, 'b': 12594441620324412950L}, {'a': 16365054778108509212L, 'b': 6915713676992293446}, {'a': 8413588309448970366, 'b': 11889036274902449531L}, {'a': 17894678422045107594L, 'b': 5920182741903611877}, {'a': 7285126389515022018, 'b': 6462147507324963038}, {'a': 4909632674033365383, 'b': 14315903695300159254L}, {'a': 1655580312553434913, 'b': 16367016374714982124L}, {'a': 8885970155558257648, 'b': 14529316141033179050L}, {'a': 9081396196156929867, 'b': 8561049661810074360}, {'a': 6305330131812780041, 'b': 4871067444962254093}, {'a': 9765624861198735320L, 'b': 17518630459953957008L}, {'a': 12174054973172448609L, 'b': 11951836571754949682L}, {'a': 9073268482984339659, 'b': 1165944585789818465}, {'a': 10015945713639094466L, 'b': 12305175910755588218L}, {'a': 11481268476409573764L, 'b': 13426883452938411495L}, {'a': 5386599990668323256, 'b': 4447562115655318437}, {'a': 13263433914756649098L, 'b': 13915931408736053980L}, {'a': 8351177336050595777, 'b': 16761948258221167281L}, {'a': 8203988603704245511, 'b': 2463241976771407074}, {'a': 5788384747204865327, 'b': 12705529154337198398L}, {'a': 18043005416534712290L, 'b': 14224810046275791426L}, {'a': 15395875626914059934L, 'b': 3692046416845805583}, {'a': 4846525530662762742, 'b': 7385897155396316446}, {'a': 8414414285226700165, 'b': 4418312233725036407}, {'a': 8326759454995193158, 'b': 5889200971461061331}, {'a': 2524059605070908325, 'b': 13939202408921244379L}, {'a': 18064299897576051900L, 'b': 4924875621490466135}, {'a': 12159887543410558915L, 'b': 7685544086969630127}, {'a': 7684101984562269782, 'b': 9818378763496980943L}, {'a': 859987062004399380, 'b': 10052927211088813243L}, {'a': 9435860833109438012L, 'b': 1949549176720743801}, {'a': 7521396161869820115, 'b': 11368783416994431386L}, {'a': 14958404237072414457L, 'b': 3813505556063968470}, {'a': 11980797651495971839L, 'b': 10894056047330512618L}, {'a': 1452553076023110113, 'b': 11366434437349797654L}, {'a': 12839265262259949648L, 'b': 5168465137810587077}, {'a': 10405858179587578144L, 'b': 1333441688891995647}, {'a': 3165252584107870222, 'b': 5055908016306991638}, {'a': 13394952747819401674L, 'b': 4170230380256265505}, {'a': 5341616601880038075, 'b': 3263007946332862121}, {'a': 1598438397298686786, 'b': 18413541514477818051L}, {'a': 8395081356244066308, 'b': 11481722295162705502L}, {'a': 14229925592826936900L, 'b': 8108520785686841319}, {'a': 15810567724984262043L, 'b': 11511262545985288914L}, {'a': 11747954791791959985L, 'b': 10390671749507601695L}, {'a': 14944054498289484481L, 'b': 2079203201502209625}, {'a': 14603187945895711960L, 'b': 13473477037344584590L}, {'a': 10983156765930715910L, 'b': 14902114367271230392L}, {'a': 4978300750799802911, 'b': 12625811286768352190L}, {'a': 1029522930385249284, 'b': 17927710362856968959L}, {'a': 10231014683345064525L, 'b': 5289907767321094414}, {'a': 11575762115499270447L, 'b': 17840574677556498838L}, {'a': 14738141116137505615L, 'b': 12830118117154420355L}, {'a': 16030113542971286444L, 'b': 10788486335881793822L}, {'a': 5494406842827561060, 'b': 14363518452265258347L}, {'a': 196509551824509370, 'b': 7452769988624042850}, {'a': 11879849638262813473L, 'b': 3695362415681182605}, {'a': 8117035366176121046, 'b': 8775671263141505545}, {'a': 761143595263765093, 'b': 8444218313777431258}, {'a': 15045955817974890037L, 'b': 6772812101111744317}, {'a': 13376354981649981303L, 'b': 11166138499259003116L}, {'a': 15700055454057274791L, 'b': 13304183026216067036L}, {'a': 1757372019556435550, 'b': 16005215757529179992L}, {'a': 16559409254221073525L, 'b': 12234214542153638528L}, {'a': 11163800735912965377L, 'b': 13716343869139748129L}, {'a': 15075091666361596098L, 'b': 15051690846715740941L}, {'a': 17429903325030568216L, 'b': 6261664563134492140}, {'a': 15711385029115583257L, 'b': 15087220248092508288L}, {'a': 10514180653248945129L, 'b': 5434379203309165764}, {'a': 8127186406403374399, 'b': 6566378918441458969}, {'a': 17989453962047725810L, 'b': 1634853986541149235}, {'a': 1043004623874515197, 'b': 297546035811033557}, {'a': 16344153534297102893L, 'b': 2189774368552675128}, {'a': 6895771409777582992, 'b': 2871642730309916034}, {'a': 9171156337947874491, 'b': 3155619798885141495}, {'a': 15448379696960526042L, 'b': 16071008118693014570L}]
    sketch_exp = np.array([
        [2411263172189157419, 2234865951714620069, 2581710506058444518, 3358244042405156289, 2212128273141684754, 511229589803159708, 32960646880241106, 1356703950507808912, 2234865951714620069, 1683942192118109648, 705936927192924220, 673686318501002356, 399792654726552352, 2231962383176841376, 1515058829394101884, 1356703950507808912],
        [1025319793325598659, 3428920476968864166, 4400464608711036379, 1181271222968058705, 1041668879064146517, 2029579102707291704, 914554413134107909, 3676539204363147123, 2980435718022661134, 3008726511404397793, 4125967654329834885, 1033713195779028758, 1939806301476900651, 2495813765347904771, 1181271222968058705, 3676539204363147123],
        [3518979409555793774, 412656820379556010, 4983826410135953525, 412656820379556010, 216022798132094907, 412656820379556010, 412656820379556010, 1324263281237619637, 860905422928575740, 1026746335085464987, 1324263281237619637, 1324263281237619637, 860905422928575740, 1876682356144161341, 1165677402430632849, 27057750632492000],
        [432441618293727358, 747463825141822562, 2782862355736030165, 2628994343678122055, 1762824695693256509, 1002364579975999964, 91987921992213902, 444234096325989812, 1381562978384106705, 2357535053127237436, 1819530166691325734, 444234096325989812, 91987921992213902, 145877570157039894, 1468899152159285017, 444234096325989812],
        [2201175962930638606, 52949846966918023, 2650265554274349507, 4846712603537277605, 3905140647748475851, 2650265554274349507, 564235627542513832, 143829477640849136, 925456577408913921, 1044546799158205617, 143829477640849136, 245083954617336217, 925456577408913921, 1826152632619825209, 397465873533707743, 143829477640849136],
        [325596594331057877, 5014570891479153913, 4285601985988580409, 3456763993518523698, 650803883109853526, 2257120959641229636, 510827755563577186, 57976119132472858, 3137116482175645435, 10382204466077072261, 634807076887782355, 634807076887782355, 510827755563577186, 936972164924703022, 936972164924703022, 57976119132472858],
        [1145103200149584620, 85879801576744501, 1145103200149584620, 167296457116008345, 4085597137917007812, 1145103200149584620, 496387489523057224, 3521024664250921302, 769397721088075225, 496387489523057224, 450359888626576073, 450359888626576073, 347100549307700285, 3150971378284955480, 1767556586804061781, 791264781067526054],
        [865720956162607214, 7051997181073014941, 2518055481778826254, 581496688099941334, 4147733623990745781, 2518055481778826254, 1964548620129099273, 454346404223049807, 1088926728891540064, 1998409959837245517, 523448790331289898, 454346404223049807, 1477760916145079486, 1964548620129099273, 2320749905553643721, 88948533248256332],
        [4962818854947210798, 3054536980645632508, 2075427676292592726, 856963273125269009, 856963273125269009, 5136294170460122372, 1825685172329182587, 1397080946084570919, 2686666431007879144, 5328005322315431663, 664483009764691274, 664483009764691274, 1407471561344513818, 793903395156125755, 856963273125269009, 664483009764691274],
        [1815581336149048678, 3113129336418835753, 3857799638308618707, 40072534294713720, 662893242465666290, 79886404259243454, 826385361184479829, 1242272989393904171, 266229304738430822, 3720601082510031421, 826385361184479829, 1299189177974236070, 759672121463604800, 109254193158014507, 662893242465666290, 1242272989393904171],
        [3295418679359283545, 1620393099936792155, 2770851772753315951, 386692735300513776, 2738066559712795225, 1966113341406038131, 1045585162771318052, 142327043946442976, 379371281197866979, 822686524507043873, 1312813189679201439, 1312813189679201439, 1853509368482809753, 2953994484781947135, 4994070268468985294, 142327043946442976],
        [1023434209283538460, 1752544475222911418, 918192651054166435, 1860444462688497070, 315349846330829490, 1122454391339298516, 903051892438107839, 1999966546650902445, 2779151939960042669, 903051892438107839, 1299928783336406016, 1299928783336406016, 175180067115448707, 770181864588279875, 3017841524070601703, 100856198237093240],
        [956731736799978329, 846741717873708537, 5183384262197149718, 27126278064562004, 708220279522299342, 244322671058172644, 228341831363413653, 403724256515297352, 1692247775308219368, 3261997943450051891, 1150190631240597930, 2417830762885071730, 33300942192355683, 1692247775308219368, 461358222498477812, 403724256515297352],
        [565652059416591487, 1478782578576556504, 96489158847326868, 190478440029413099, 247254136947066488, 162881898681823485, 1419501688805878910, 762851480677783702, 1697213628778149885, 1419501688805878910, 278935559130694506, 278935559130694506, 247254136947066488, 247254136947066488, 247254136947066488, 432143216315865561],
        [500642349258103388, 46675730697514594, 8050617556581150361, 846360539392457419, 146047403292353804, 126069023431133508, 440940590630148634, 2566641457009912589, 136124315347923907, 1845582999467818603, 316752364351432782, 316752364351432782, 1776437142579140051, 1767738377772109542, 1767738377772109542, 2566641457009912589],
        [2018148326242726540, 3374056178325994340, 1131825238583680297, 972533780614125287, 972533780614125287, 2359859641303941133, 2978653849356254597, 780080220244541603, 1213838695577975705, 97331116353417709, 780080220244541603, 780080220244541603, 2160503405468622540, 177867838238532555, 177867838238532555, 641680337189456525],
        [1791569510325998757, 76520549469883965, 3084132180277505674, 313048444452058981, 1851329695848316381, 242738853430325733, 766582549566523999, 280288777267765577, 242738853430325733, 8588288434733474266, 1066193139856834785, 224488457339285201, 2608974099791692597, 2331124419142363594, 1066396416392405557, 2677238234392619671],
        [2507965299290791146, 2906506427086351726, 2507965299290791146, 385291001195484405, 507642699673366632, 336507937616963418, 3386658339088451107, 767924480029653231, 1899234811011148573, 1618964941749752846, 3629972905113281212, 3751983334924949132, 507642699673366632, 146278532742778271, 507642699673366632, 2991732826043653563],
        [400875418379574198, 298943538038833091, 771630719387652630, 1197573458024153602, 1955574343349311735, 1197573458024153602, 40537214401755024, 895129145391172051, 3885636911964433423, 2847825074012270658, 1819507893865287565, 5830887037735709884, 1955574343349311735, 1955574343349311735, 706478823288444496, 895129145391172051],
        [995335262615156159, 1877785727482274090, 1439617611892445337, 344914684360695516, 3898697475645713374, 3657278443992677207, 943383747047401812, 5649827742919885597, 1877785727482274090, 1570998048171902819, 258645107004870007, 258645107004870007, 3812758216828119416, 349473587859080688, 2843691398989425805, 1673531010815333323],
        [443548720817148216, 1155626142704061751, 2192973602171940397, 730057936399064557, 138943279114176030, 1148793713629088536, 538726407770258560, 1173542903633277641, 432506828244348352, 138943279114176030, 1173542903633277641, 1014018292334316115, 3045107272685736800, 295372032644169732, 479717682982630844, 170743151808400852],
        [338461888642770287, 386858723110616166, 401564392416847, 5490129864665431344, 2628987460065997874, 55228141308820090, 341368708799351473, 542559884781066011, 401564392416847, 1604116432945660434, 542559884781066011, 542559884781066011, 95589095857774161, 274927381988416755, 470756732685172381, 401564392416847],
        [2203708330863066746, 225661289879431753, 357698429534860599, 3285203758771307168, 5072538381413092425, 2575240798398226470, 1393839110966645823, 231132713579917370, 2015754059351915214, 8810934880505991655, 1339888650141329464, 231132713579917370, 5506529533579902313, 868263276359821776, 4160231283109681840, 231132713579917370],
        [1450645747381645887, 5570850870039791931, 2696772435519178242, 264517874040288067, 264517874040288067, 1290242263111261044, 45142056039326179, 567743359988356234, 2696772435519178242, 959965317048398344, 751218894818674527, 751218894818674527, 1678785207235510474, 1328596551169922719, 1066292996607523338, 264517874040288067],
        [7721204036235231230, 1637873083597578358, 3735302106090646417, 1487281002815422761, 1523081446825688345, 2044842121219783698, 126814754904507215, 12151360409572168, 1774554042854410004, 3300128030951645419, 12151360409572168, 12151360409572168, 730367980088307045, 2305195176924274413, 1196587501681423673, 12151360409572168],
        [745913066352233362, 5551226246125744102, 4497842942525212060, 1143173913869951357, 1066900369135549014, 745913066352233362, 225061969082590807, 2685323774610279860, 501759899944083321, 7610956093683582620, 310456885718235511, 310456885718235511, 3231482275651082134, 234354328651221840, 4349460314541652528, 2196548225239331387],
        [4682369455166576545, 1905585976936507712, 5567315908551620586, 784043103547094200, 488050444276051771, 3941406493863803396, 1090014072862770921, 358484585839617730, 964666907783937510, 4163717705090752632, 3678234427588575110, 280626254838446444, 6551979082428621400, 964666907783937510, 322938892564080389, 358484585839617730],
        [1003607226887181894, 4000724589080346594, 2635870307343126622, 1265716568875604686, 3158258773251900815, 300227660297510459, 892370966238499338, 1294795026536581844, 768949032860383438, 892370966238499338, 108459983961958109, 108459983961958109, 3434211062869634810, 594149163459215329, 2084816192313011095, 1294795026536581844],
        [3611107267854515229, 3611107267854515229, 511114472624993702, 790244751434551841, 1695025127656624082, 2536651678120529512, 593994388266530044, 1419015325927208087, 75517872322065857, 2969540825807323511, 6424198077638697430, 5762894644069558420, 1195792569802344346, 1140562200372690326, 1797600889120671269, 3290219597108130166],
        [1278916011098373714, 1609540803108453840, 1035663522772361412, 734966224981731189, 3821022464055311490, 445015715376470517, 284725001877423863, 861016609806506194, 3167025376758172156, 939132658976482417, 2131275464127369229, 1357260059961090617, 4744443816424672443, 816373758831975201, 361715480834979286, 187993286249952247],
        [69991973846107653, 1036225850501253577, 443204000332736698, 69113174936300335, 531874575732548369, 286851233393403453, 1402357247610031726, 2768530321056659524, 3149830533223325532, 1022858406570465021, 4351786298967339538, 4351786298967339538, 946618712047353257, 4183653206729812781, 3001466487943977480, 685035889144572600],
        [5122029036049789585, 2160576651000435055, 1424596414631453305, 573540245714126682, 405307432391602816, 2160576651000435055, 842478455339138023, 5022639833321060760, 1424596414631453305, 2829400565017638279, 808649888247525548, 1419495017736375473, 2039670878217369102, 449943195296371108, 2019553041685236747, 107759886715274264],
        [1752009843547119900, 1730114658358603488, 1573176113912640818, 101842887331293979, 460929469459028133, 1099909420494213501, 872305589297975780, 807533882278762058, 3286264576116976892, 6436019905424176705, 2016391301230157723, 2174513095598767633, 460929469459028133, 460929469459028133, 460929469459028133, 807533882278762058],
        [2243499432375307035, 1241032830050098553, 1082760797079533777, 1822401065888123511, 1823035175016300524, 542260076762032999, 19268530996891516, 3047759643886234501, 42862817337042881, 1226592289589128462, 3410462917280853033, 514973233473167266, 42862817337042881, 312819681127367331, 4402125677091884026, 3036083063649340274],
        [5257118577426487134, 5602943916620897315, 1086861988367016033, 154577029903023652, 3735049964779785, 5257118577426487134, 3301068595316154, 749496214428196530, 530325671082886408, 47358745158215426, 3108006783845242695, 2073833825071010288, 530325671082886408, 1142892874295358085, 2926830468720930078, 749496214428196530],
        [226252467523372988, 251980705518744042, 10301084366034150, 1147503325785445023, 282834260296114052, 226252467523372988, 226252467523372988, 616379384631572811, 226252467523372988, 1007697358284596920, 1967541214121951526, 1967541214121951526, 4208207366810081951, 537151898116096870, 537151898116096870, 1967541214121951526],
        [1984625468109816129, 409101775037099293, 4865217163498150603, 409101775037099293, 240381563453208893, 3760119960231654288, 233933986625250893, 2631630608772785082, 695766532806858271, 2700640627571032584, 774756070354474221, 774756070354474221, 15806316100594368, 1686691118656641468, 1121689484801387787, 774756070354474221],
        [1455197498129315287, 6579301268792313379, 2504755416887666130, 1303809433098436577, 1656236966092010348, 5217248708660288306, 2046155040435980470, 1516946428740999918, 1732854736189476023, 3843268829403705450, 1516946428740999918, 1516946428740999918, 2549021080213142517, 724176298974799647, 2549021080213142517, 1516946428740999918],
        [5298660831475732112, 1490158367118567541, 1673567706388818362, 315630876666951535, 256570634628488237, 656113388045373163, 452612078295093947, 944914915975159062, 1779371507177614023, 2887354043268237350, 944914915975159062, 944914915975159062, 2173616032266348703, 452612078295093947, 3127495106294202, 1321076702814404458],
        [2879983089422264399, 1957637342540719966, 459343591756225669, 1000600495069285755, 236590046604449375, 4158681732129078224, 1166771837256967345, 4721481082825409838, 24020087781013066, 1377322618900513104, 2339805012189969372, 2896835422778485336, 8347935062382171528, 538599304038341301, 24020087781013066, 3506176743916978559],
        [1045465898481088513, 490723927641254275, 678339314788998401, 1121976534903244957, 1940029267726983933, 159291163978681153, 549352291955200843, 1619715588143497821, 490723927641254275, 4140341221363021282, 3507675180893111093, 118898436961635520, 93370359079483787, 108279757792269376, 93370359079483787, 211978373647610510],
        [3269354743218078227, 4786869218393211258, 2694141015623112388, 115990529245220797, 3733770067889805418, 1816714560377304414, 479464945415482278, 1167865379844131652, 1231895288376402382, 719292043329264023, 52605010231776921, 52605010231776921, 1561666038488330123, 837335787131719265, 1231895288376402382, 1584346200020908889],
        [470796353534369709, 2357057172522353900, 1028015958646857773, 1692801036271537167, 1078808087189529388, 2494893264849083506, 60148564627414443, 118492663592610182, 941918064920240559, 2165984193398844003, 1502917536485221635, 1502917536485221635, 941918064920240559, 60148564627414443, 408364698721924535, 1910087317958508097],
        [1155700898118830439, 1084356584421203868, 311405574664420237, 2466099402523857268, 733782975189147661, 1859932739680346459, 543922588079879304, 4903211593107730564, 1290299951734591772, 8162510917946209968, 1119751492784685474, 2035438502876258721, 2074963042972564025, 847671383953836449, 2263907119760921110, 609377596216737889],
        [154711771858071, 55468665445570576, 237363846252553723, 3096982186318371368, 514010966179462031, 2035700793770942760, 245548886003661239, 1438429830236261314, 237363846252553723, 245548886003661239, 1360594310485121959, 1360594310485121959, 671379449678820240, 671379449678820240, 671379449678820240, 237363846252553723],
        [2437824556334322664, 1327944091814516, 2437824556334322664, 990934223284995950, 990934223284995950, 1799408549965431412, 1327944091814516, 1998520904854191423, 14526111440992643, 5102116698825863062, 1420084435575268772, 1420084435575268772, 1415057946067442479, 3081830294574092572, 14526111440992643, 86433946418519345],
        [726165964911441725, 1290031743804085157, 1491751358677999712, 2717660056359078836, 1703004162711837702, 946997810785904227, 731166317652454512, 1805577158250938426, 1290031743804085157, 4599826600258790650, 696417050084143734, 696417050084143734, 1346716630680451060, 2443500989736135085, 6664989583898838322, 1614985381585563834],
        [2116697217889747992, 1550173835065628664, 3073409753182523077, 2116697217889747992, 680798060111231962, 754992939039925679, 520421045944523310, 2582677002665688410, 107024727007934974, 560394978955021456, 2086683918681150674, 1371443904650157309, 1507758909423202485, 185905279125392448, 595360746417596760, 807411691821217224],
        [2654649396073909152, 1236890816770088021, 2654649396073909152, 61480161788576108, 61480161788576108, 1236890816770088021, 419191369823524212, 1021265703863408225, 173746624095323779, 1925787282260096465, 576136013412525231, 576136013412525231, 1766298980057177238, 583001662692389948, 61480161788576108, 933347567175319556],
        [162381126484216998, 162381126484216998, 162381126484216998, 3526442205603174806, 42896007026568633, 162381126484216998, 212497282300961836, 2995183997582302609, 133784810031090217, 1362527597848378485, 47292375034879860, 47292375034879860, 2284524438546405473, 1393568949322248045, 1393568949322248045, 47292375034879860],
        [1244564579892644099, 2384058739614545882, 5183666742745052094, 4156969869363126960, 205045701192565787, 2840896884681401993, 389561940626337937, 2238039436971545023, 2581581641557510874, 493939191807372195, 2238039436971545023, 2055846694790224217, 389561940626337937, 1311043308429072107, 729637280385005087, 407528985926911386],
        [1692687905892211162, 1374567101245426267, 1692687905892211162, 1700448176898817818, 3348629881035457429, 1700448176898817818, 796761615730650589, 893061826887774847, 1881757836903649645, 2019010940228239064, 893061826887774847, 893061826887774847, 1881757836903649645, 728770775010334890, 2642513482621239627, 893061826887774847],
        [347761814437690165, 1604972377186252382, 347761814437690165, 689238419516512797, 1778129307330837703, 460829735209657318, 405692256541376462, 8087908586174252021, 506513630055425553, 3983128241356160735, 887344463301421217, 2507264969441845882, 1694427756434606799, 958732602009533496, 5924290574271460236, 2239609022124659502],
        [487729903836169284, 2633341129134704377, 338576838058582434, 2232499135985090591, 2023648209282999747, 487729903836169284, 146008156939311564, 1014107061895884345, 71878219194878876, 2023648209282999747, 1014107061895884345, 1014107061895884345, 676756212705220879, 146008156939311564, 2256801596920956351, 1014107061895884345],
        [7802382392246907241, 416914671246722394, 2600486227529144277, 3228954992721840054, 451733130028105081, 2839260961065603742, 139973529965922672, 431258309708740559, 625500306151306024, 1968895127345668269, 431258309708740559, 1374358689643872886, 2098382765552014515, 1962901358633128992, 2532308485823678208, 165944187410200187],
        [1799750695355279750, 608071339674979401, 908089208557273300, 1934010952855738013, 198306382626821734, 3003748033853542699, 2806571721352151155, 6832184287540620161, 1794490129987571317, 6537334320361912029, 1586014069733743569, 1586014069733743569, 198306382626821734, 198306382626821734, 198306382626821734, 3107916512927546408],
        [5169263843528212382, 137066406065001478, 5801333781380357239, 1974120631828992388, 419526020030035515, 371222201893584609, 794008763936582752, 176991043049774527, 1988424530715825417, 3970404390200865156, 1982377958622942, 1982377958622942, 943564045112046799, 943564045112046799, 943564045112046799, 176991043049774527],
        [4293411499369566268, 462445302543173314, 2719329481545035154, 462445302543173314, 2883155619679733982, 3369857363958661089, 603084015697320086, 2853402040791588605, 602459119884305177, 3753735515231450954, 2853402040791588605, 2853402040791588605, 707447151178481314, 1164626438062773967, 776498695105056278, 3318966979611888234],
        [5076104672582672131, 565181087085395391, 1131473417219721867, 188147698920243517, 2065880880737938944, 5778508859194997533, 262737329478758765, 824029242387145023, 565181087085395391, 3066946638304896138, 824029242387145023, 262737329478758765, 790068605497809873, 362032701474014187, 2065880880737938944, 1175378869225281632],
        [2569826315084830119, 3601200146761997374, 3601200146761997374, 3768270875616931316, 116750061918368119, 2631191234563237479, 381298720856998128, 1517274351539548412, 1280918883540472191, 2972328429987063403, 1517274351539548412, 1318171308706068338, 222723505256295221, 1734854118005744474, 2166370365470175185, 675551294272391206],
        [139874558023443785, 1459984955897771469, 1398671273109978037, 139874558023443785, 449422619306229855, 139874558023443785, 113189403984720419, 865489330840431922, 1075041090214539468, 220865738462540235, 865489330840431922, 883130262942120364, 113189403984720419, 2160329704626263820, 2160329704626263820, 865489330840431922],
        [2516803786784548684, 263701734470420815, 3327586418849853089, 2191581645485541173, 596001004634345539, 5917825689498824158, 263701734470420815, 1934961645645613929, 3414654320675466490, 2009883254947836185, 6194772057800711606, 4505408400965099654, 6224392985922906305, 878554910447404672, 2311826947917750230, 1934961645645613929],
        [180533196118046891, 710222382296470880, 180533196118046891, 710222382296470880, 25961972979757056, 180533196118046891, 153087498702959394, 1058328837250061331, 180533196118046891, 3617755148967198632, 1058328837250061331, 1058328837250061331, 1876206410536703367, 294125662637529159, 658575021752038283, 2329357960940242821],
        [718517561243949152, 2102655168058681604, 2102655168058681604, 718517561243949152, 836923878322790032, 718517561243949152, 864282875614712514, 1622168323017212744, 1416897661664470036, 836923878322790032, 1622168323017212744, 1622168323017212744, 3196196297287294118, 1528095038714454851, 1104798734662211999, 3272062271721405277],
        [2003589780096624, 19073038959018250, 19073038959018250, 6966705285079835252, 3449409595331898567, 19073038959018250, 1839979557038416911, 5056259826808935213, 3233301690977074702, 140167600258869535, 2388407922032372827, 2560601884292485941, 29924011451671681, 502762958333143367, 1160145197700537765, 2747456709786811326],
        [321961205119076060, 822850551214092150, 2524628601105996804, 4037335586301872180, 2292357242498167024, 1927974272559080486, 177230603237117787, 3261827524229832283, 822850551214092150, 1118651131273383946, 1108109743240731963, 1490580117584160053, 2021168628244302165, 3671266021312820450, 1609588643111751725, 572976151500933089],
        [2798270244413044910, 6644111666264860783, 5481491276463393876, 1961520264103043996, 412475584655487123, 2014110340681950857, 409600320113534256, 1194257209910904780, 562939460626680709, 244685253958471234, 409600320113534256, 2589224885095141210, 792387894154590222, 1033882863551014964, 562939460626680709, 1194257209910904780],
        [689586327367746633, 4571776908323272489, 2020063609127171338, 5023276152912925362, 948156988312318328, 236064213502693111, 39249065406960186, 1325949204714734063, 79169258322423970, 137158393440812994, 1248431701743902413, 1248431701743902413, 452274643864143338, 79169258322423970, 79169258322423970, 1325949204714734063],
        [735897300785390148, 1347233928185392562, 388177454483594076, 381793089554933802, 78754616700549515, 735897300785390148, 303152730991479186, 2707325353039912047, 911666245990080306, 590437144981433593, 1564291947611285912, 1564291947611285912, 2473651621428945795, 808052742949428374, 911666245990080306, 2848281963649227380],
        [1078217322094656960, 1010101791640603703, 3627677798634217742, 896240810696878737, 365539153165377932, 611630050341576693, 213164514798333044, 1391098520342829686, 582152796808580512, 734488010087337050, 179303544072533715, 1372275741834352443, 1052510882406292069, 160765500522687531, 1355457697150965925, 1391098520342829686],
        [1905145171633709821, 118711788177625751, 3610182256900675576, 1281190925349334672, 988731227841348443, 159960623561093891, 1168344204571276212, 429412740767471802, 1132199337599009149, 2864586187242406188, 1140099717579111236, 978349246145204341, 1132199337599009149, 244729613901861890, 244729613901861890, 429412740767471802],
        [5819546932109438521, 3340119149426180888, 58190282336036671, 35703666950168538, 2751595845745854212, 741546966940507205, 1029746448779698327, 619602540277936662, 58190282336036671, 111296907405792756, 2505055371921543563, 2066641313745223562, 1372243575683264972, 1826148165458743032, 1372243575683264972, 58190282336036671],
        [5779690977116093362, 5259363448906012, 1342825787071091015, 1848040743950144867, 476016116986950829, 1848040743950144867, 632082358844094340, 589944009488069653, 81427954038106656, 15531353225659668, 589944009488069653, 589944009488069653, 1862221829125548477, 2281908064550149974, 1191797920825023869, 589944009488069653],
        [7238503918932153059, 3727085768832096167, 8640310043073607, 891257827963134378, 1013338923219579432, 3060879473843205758, 152295908334233514, 1341338711137452031, 1798227498556881187, 3600538738294225493, 1341338711137452031, 1341338711137452031, 4052752670750555633, 1798227498556881187, 1798227498556881187, 2901478496354330846],
        [2019120444157178583, 1506061575448259700, 364697835632206379, 3376512214353800942, 2264888614293762893, 3334428008847936255, 523828783612169291, 1954813774574002987, 1506061575448259700, 460833312007992455, 1954813774574002987, 932804249873347524, 301055286223699666, 2511769085983342205, 3275613590134201340, 1954813774574002987],
        [27188263782036361, 1309844957385747473, 1309844957385747473, 1335691528399969480, 1335691528399969480, 27188263782036361, 378554196779913345, 2180353765165402580, 1392311961525788248, 7873648829666479034, 2543919205261515568, 2543919205261515568, 3999368618156437580, 6167828789330727050, 9132746415490688168, 1335691528399969480],
        [1429842222910684614, 623640178912877483, 2082919449076017555, 1013432511816286623, 1013432511816286623, 112720029297295350, 117570921530514257, 1346116132879525454, 203896044026270866, 2603563121653975448, 3127493450597267278, 3127493450597267278, 1954973132100594822, 472635156329109412, 1013432511816286623, 1346116132879525454],
        [76396388512378538, 6757960883362986705, 76396388512378538, 1233346568387571352, 720548244593342024, 76396388512378538, 76396388512378538, 1413461954324131561, 76396388512378538, 871728204622931330, 412909396742274622, 412909396742274622, 1877762237683881043, 1489411604061821204, 1489411604061821204, 1413461954324131561],
        [862414188348584254, 3577366004643768989, 2346079367669543046, 1747935784941769353, 1372146732920205301, 1845224408227275800, 123549377887014947, 187185684840762722, 422829981840283318, 123549377887014947, 2282004171273527716, 2430781913105433949, 1876534563922880916, 240087924336193036, 1747935784941769353, 187185684840762722],
        [1586976094707364657, 1261441867646247500, 2718905606465870495, 475442548872629225, 475442548872629225, 3191151967018315877, 578153845875226500, 1201848988283785615, 1485848340420051517, 358136770692810421, 985794857561959886, 985794857561959886, 246657510056874339, 2235181518227207759, 475442548872629225, 228323326176530478],
        [2043480409369479843, 1740510731937287486, 1970927071407306443, 477943898253351247, 1036935372198625351, 2043480409369479843, 164967378588516944, 3766442477347022665, 1170856372763145579, 5203045943036950809, 953497635629666121, 953497635629666121, 6277483328964916863, 1170856372763145579, 851797845735600241, 1036935372198625351],
        [1076421487260774196, 569286648203695490, 453249078954669750, 84255140036055086, 326160493281575234, 1076421487260774196, 143862526620401689, 920304163125278855, 616737456898830016, 198439092701426583, 588309806711528751, 588309806711528751, 2517987184557510278, 256309122131886920, 3101804505927042545, 326160493281575234],
        [1845208826392722193, 584827261370434736, 1641814914592987140, 5339463331183461504, 1660743660055638298, 1845208826392722193, 651540528143659275, 345583792087446102, 939963416433741125, 6963475530233640376, 345583792087446102, 345583792087446102, 831773963476413667, 497686386957940689, 497686386957940689, 78138896714195947],
        [67078796842845672, 1297446524523073583, 2634583545564480098, 67078796842845672, 1837293669595683769, 67078796842845672, 747672832702390730, 617469762416110588, 1723283064846410927, 1073550236186808866, 617469762416110588, 617469762416110588, 937884279671865386, 369742511937358533, 1400282699212051692, 617469762416110588],
        [231808359431590803, 231808359431590803, 231808359431590803, 1618886617738382934, 956924755936182797, 231808359431590803, 346870535404578085, 1960981844640808179, 85771337767036354, 1143981015248747609, 966454374419585733, 1276055439121606939, 792544615771465606, 1050187124919889121, 3773053212193334527, 1276055439121606939],
        [667265205317351110, 1012504723610069347, 667265205317351110, 1012504723610069347, 2365165460430142811, 667265205317351110, 667265205317351110, 478740368494222773, 203871289935878297, 4044977239799723352, 994084423523861179, 994084423523861179, 2500784126106688254, 225785191839631098, 1476289539404673026, 2164919961846939679],
        [3279565930345053407, 1503949827389500713, 146830448554736224, 235925774370300408, 508168553912617799, 1851653250877332220, 879461207283242519, 437357867061705975, 1154511708710765653, 4103613638003546722, 499718915788027989, 1972693036214025922, 1320719059060435966, 437357867061705975, 1154511708710765653, 499718915788027989],
        [3691594340281172833, 1648888345370873695, 5228802470830787431, 491315823492345128, 491315823492345128, 879934874583114055, 944971720844092189, 474940092992289602, 2699955298675875434, 1378192885517418296, 474940092992289602, 474940092992289602, 586567077200907850, 59628377464778765, 586567077200907850, 491315823492345128],
        [426710952325416957, 1350200756068768387, 2778809522189597821, 2309398692424490468, 305915290021387382, 680649942718635534, 823876215396069453, 253489159321129205, 340219119076377342, 305915290021387382, 352435188316675772, 352435188316675772, 2649075639828382891, 1047005661227475360, 1333419947320090486, 253489159321129205],
        [1979450353548296300, 5548408802360718590, 1474913693108377775, 1908597341478993744, 56275940116485044, 1979450353548296300, 265837824318755165, 3533264692371660053, 1650502824982224042, 3892809486561609141, 67511205064385828, 67511205064385828, 56275940116485044, 56275940116485044, 56275940116485044, 3533264692371660053],
        [20662331795707594, 915864738710972013, 403168924833612862, 915864738710972013, 5906207902816006132, 9302034566815601, 364111042750991096, 97554314458723254, 4120438869140569272, 5269251233214929231, 420164140095291088, 420164140095291088, 265965970504514202, 97554314458723254, 2341005564246359696, 420164140095291088],
        [199707318207927239, 729684158310804773, 729684158310804773, 598825705962994898, 670124819990610880, 729684158310804773, 2550536707352407693, 5879475942553766130, 706018886449553033, 670124819990610880, 2867290310065528699, 2867290310065528699, 1430378271356611703, 706018886449553033, 706018886449553033, 1195384224354439141],
        [1164547623571578948, 1164547623571578948, 1164547623571578948, 1342705335261358280, 2825226368318361616, 1164547623571578948, 896843745101553842, 915428537674527808, 361661919063465241, 2859783577819728759, 68624561079121309, 724477200003372890, 361661919063465241, 575929868132920744, 3251345644459028366, 724477200003372890],
        [3622208922194750547, 48880856655538814, 534929657259743825, 48880856655538814, 219250389601032963, 2134301179214077686, 2064806924076609274, 493236902794722542, 534929657259743825, 4666443080635834982, 4871904399823999678, 4057121263725433108, 907330006925506036, 288425604534829467, 2815651194010914280, 534929657259743825],
        [3983454189782296858, 936067677635978241, 3983454189782296858, 518348224679513438, 1229016580480261479, 936067677635978241, 936067677635978241, 2385235924153688813, 469001313468754577, 1229016580480261479, 2385235924153688813, 2385235924153688813, 1460466851912079125, 1055737229482488539, 2016992669303551053, 1443523007333366638],
        [2520699270879443943, 25219249268025617, 1125671983153309008, 670239959617556088, 584893347770859554, 3000093410803741762, 607951190646758390, 636515071700362898, 25219249268025617, 2670964242275030785, 483721224899232037, 483721224899232037, 2181563691862033876, 1709716808945620777, 2181563691862033876, 483721224899232037],
        [513471821254293745, 355388607371445725, 513471821254293745, 681119050839755418, 681119050839755418, 513471821254293745, 203733901512192829, 247497750599454252, 1227838993211432633, 1779597391713477447, 247497750599454252, 591825911202302972, 526823992078827966, 2264132921031601479, 681119050839755418, 247497750599454252],
        [1491044087885022189, 1642768636217231029, 3441561290804765977, 4429890024905696590, 96831865502359456, 2962707349741784787, 71777511673816477, 2151674308076870833, 1239462201401104826, 2692996470363276257, 2151674308076870833, 4581530809435422333, 1338259715671577397, 1338259715671577397, 1338259715671577397, 2151674308076870833],
        [709832428428276609, 503821524091826404, 709832428428276609, 2884423126638602520, 1142983085481980390, 709832428428276609, 135876928373090586, 2511499696131020752, 137111887777968231, 1938044385271552084, 135876928373090586, 2511499696131020752, 1130974316853455681, 862252161378598192, 439657550492358454, 2511499696131020752],
        [4518513783681841616, 2847747410340632434, 2480321539047568229, 604796026250160955, 308955979692266412, 4687598803858476292, 748824017672869141, 7786766674300779101, 4120917226535409303, 683876327976719326, 677877083576276291, 677877083576276291, 308955979692266412, 308955979692266412, 308955979692266412, 65272705644770674]
    ], dtype=np.uint64)
    
    def testFeatureExtraction(self):
        labels_lists_exp = [
            '0', '7', '8',
            'wl_0;wl_1,wl_2', 'wl_1;wl_0', 'wl_2;wl_0',
            '1', '4', '5',
            'wl_0;wl_1,wl_6', 'wl_0;wl_1,wl_7', 'wl_0;wl_1,wl_8', 'wl_1;wl_0,wl_0,wl_0', 'wl_6;wl_0', 'wl_7;wl_0', 'wl_8;wl_0',
            'wl_10;wl_12,wl_14', 'wl_11;wl_12,wl_15', 'wl_12;wl_10,wl_11,wl_9', 'wl_13;wl_9', 'wl_14;wl_10', 'wl_15;wl_11', 'wl_9;wl_12,wl_13'
        ]
        dummy_hypergraph = Hypergraph(self.dummy_graph)
        features, labels_lists = feature_extraction.extract_features("n_7", dummy_hypergraph, r_in=1, r_out=1, r_all=0, wl_iterations=4)
        self.assertEqual(labels_lists_exp, labels_lists, "The wrong labels lists were computed by Weisfeiler-Lehman.")
        isomorphic = all([algorithms.isomorphic(features[i], self.dummy_graph_features[i]) for i in range(len(features))])
        self.assertTrue(isomorphic, "Wrong features extracted.")
    
    def testRabinFingerprint(self):
        dummy_binary_value = int(216904387105353984940539780098)
        fp_exp = np.uint64(9332362780641028011)
        fp = fingerprint.rabin_fingerprint(dummy_binary_value)
        self.assertEqual(fp_exp, fp, "The calculated fingerprint is wrong.")
    
    def testShingleExtraction(self):
        shingles_exp = [
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),4),1)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),5),1)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),6),1)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),4),2)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),5),2)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),6),2)"
        ]
        shingles = shingle_extraction.extract_shingles(self.dummy_feature)
        self.assertEqual(shingles_exp, list(shingles), "Wrong shingles were extracted from feature.")
    
    def testGetMinhashFingerprintNaive(self):
        a = int(6638699916324237062) # random number
        b = int(13296106891814937365) # random number
        h = MinHashFunction(a, b)
        
        fp_exp = np.uint64(13099543915633819982)
        fp = fingerprint.get_minhash_fingerprint_naive(self.dummy_feature, h)
        self.assertEqual(fp_exp, fp, "The minhash fingerprint extracted from the feature is not correct.")

    def testSketchMatrix(self):
        def build_hash_functions(params_dict):
            hash_functions = []
            for params in params_dict:
                h = MinHashFunction(params['a'], params['b'])
                hash_functions.append(h)
            return hash_functions
        hash_functions = build_hash_functions(self.hash_functions_params)
        dummy_hypergraph = Hypergraph(self.dummy_graph)
        sketch = SketchMatrix(5, 20, dummy_hypergraph, r_in=2, r_out=2, r_all=0, wl_iterations=4, hash_functions=hash_functions)
#         np.set_printoptions(threshold="nan")
#         print sketch.matrix
        equality = (self.sketch_exp == sketch.matrix).all()
        self.assertTrue(equality, "The computed sketch matrix is wrong.")
    
    def testSketchMatrix_ReadWrite(self):
        file_name = "test_files/sketch_matrix"
        dummy_hypergraph = Hypergraph(self.dummy_graph)
        sketch_matrix = SketchMatrix(5, 20, dummy_hypergraph, r_in=2, r_out=2, r_all=0, wl_iterations=4)
        sketch_matrix.save_to_file(file_name)
        read_sketch_matrix = SketchMatrix.load_from_file(file_name)
        equality = (read_sketch_matrix.matrix == sketch_matrix.matrix).all()
        self.assertTrue(equality, "The read sketch matrix is different from the saved one.")
    
    def testSimilarityMatrix(self):
        cols = {u'n_8': 0, u'n_9': 1, u'n_4': 2, u'n_5': 3, u'n_6': 4, u'n_7': 5, u'n_1': 6, u'n_2': 7, u'n_3': 8, u'n_16': 9, u'n_14': 10, u'n_15': 11, u'n_12': 12, u'n_13': 13, u'n_10': 14, u'n_11': 15}
        similarity_matrix_exp = np.zeros((16, 16))
        similarity_matrix_exp[0, 5] = 1.
        sketch_matrix = SketchMatrix(5, 20, matrix=self.sketch_exp, cols=cols)
        similarity_matrix, _ = similar_nodes_mining.get_node_similarity_matrix(sketch_matrix)
        equality = (similarity_matrix_exp == similarity_matrix).all()
        self.assertTrue(equality, "The computed similarity matrix is not correct")
    
    def testGetSimilarNodes(self):
        dummy_sim_matrix_1 = np.array([
            [0., 1., 1., 1.],
            [0., 0., 1., 1.],
            [0., 0., 0., 1.],
            [0., 0., 0., 0.]])
        dummy_sim_matrix_2 = np.array([
            [0., 1., 1., 1.],
            [0., 0., 0., 1.],
            [0., 0., 0., 0.],
            [0., 0., 0., 0.]])
        dummy_sim_matrix_3 = np.array([
            [0., 1., 0., 0.],
            [0., 0., 1., 0.],
            [0., 0., 0., 1.],
            [0., 0., 0., 0.]])
        cols_nodes_map = {0: "a", 1: "b", 2: "c", 3: "d"}
        
        # TODO: is this way of similar nodes extraction good?
        similar_nodes_1_exp = [["a", "b", "c", "d"], ["b", "c", "d"], ["c", "d"]]
        similar_nodes_2_exp = [["a", "b", "c", "d"], ["b", "d"]]
        similar_nodes_3_exp = [["a", "b"], ["b", "c"], ["c", "d"]]
        
        similar_nodes_1 = similar_nodes_mining.get_similar_nodes(dummy_sim_matrix_1, cols_nodes_map)
        similar_nodes_2 = similar_nodes_mining.get_similar_nodes(dummy_sim_matrix_2, cols_nodes_map)
        similar_nodes_3 = similar_nodes_mining.get_similar_nodes(dummy_sim_matrix_3, cols_nodes_map)
        self.assertEqual(similar_nodes_1_exp, similar_nodes_1, "Wrong similar nodes were extracted.")
        self.assertEqual(similar_nodes_2_exp, similar_nodes_2, "Wrong similar nodes were extracted.")
        self.assertEqual(similar_nodes_3_exp, similar_nodes_3, "Wrong similar nodes were extracted.")

if __name__ == "__main__":
    #import sys;sys.argv = ['', 'Test.testFeatureExtraction']
    unittest.main()