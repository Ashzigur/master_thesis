'''
Created on Dec 29, 2015

@author: Ivan Ivanov
'''

from ivanov.graph.algorithms.similar_nodes_mining import feature_extraction,\
    fingerprint, shingle_extraction
from ivanov.graph.algorithms.similar_nodes_mining.sketch_matrix import SketchMatrix
from ivanov.graph.hypergraph import Hypergraph
from ivanov.graph import algorithms
import networkx as nx
import numpy as np
import unittest


class TestSimilarNodesMining(unittest.TestCase):
    
    dummy_graph = nx.MultiDiGraph()
    dummy_graph.add_node(1, labels = ["1"])
    dummy_graph.add_node(2, labels = ["2"])
    dummy_graph.add_node(3, labels = ["3"])
    dummy_graph.add_node(4, labels = ["4"])
    dummy_graph.add_node(5, labels = ["5"])
    dummy_graph.add_node(6, labels = ["6"])
    dummy_graph.add_node(7, labels = ["7"])
    dummy_graph.add_node(8, labels = ["8"])
    dummy_graph.add_node(9, labels = ["9"])
    dummy_graph.add_node(10, labels = ["10"])
    dummy_graph.add_node(11, labels = ["11"])
    dummy_graph.add_node(12, labels = ["12"])
    dummy_graph.add_node(13, labels = ["13"])
    dummy_graph.add_node(14, labels = ["14"])
    dummy_graph.add_node(15, labels = ["15"])
    dummy_graph.add_node(16, labels = ["16"])
    dummy_graph.add_edge(1, 2, label = "0")
    dummy_graph.add_edge(1, 3, label = "0")
    dummy_graph.add_edge(1, 5, label = "0")
    dummy_graph.add_edge(1, 6, label = "0")
    dummy_graph.add_edge(1, 7, label = "0")
    dummy_graph.add_edge(1, 9, label = "0")
    dummy_graph.add_edge(1, 14, label = "0")
    dummy_graph.add_edge(1, 15, label = "0")
    dummy_graph.add_edge(1, 16, label = "0")
    dummy_graph.add_edge(2, 12, label = "0")
    dummy_graph.add_edge(2, 13, label = "0")
    dummy_graph.add_edge(3, 4, label = "0")
    dummy_graph.add_edge(3, 10, label = "0")
    dummy_graph.add_edge(3, 11, label = "0")
    dummy_graph.add_edge(3, 12, label = "0")
    dummy_graph.add_edge(4, 7, label = "0")
    dummy_graph.add_edge(4, 8, label = "0")
    dummy_graph.add_edge(5, 6, label = "0")
    dummy_graph.add_edge(5, 7, label = "0")
    dummy_graph.add_edge(5, 9, label = "0")
    dummy_graph.add_edge(5, 16, label = "0")
    dummy_graph.add_edge(6, 10, label = "0")
    dummy_graph.add_edge(6, 16, label = "0")
    dummy_graph.add_edge(7, 8, label = "0")
    dummy_graph.add_edge(8, 9, label = "0")
    dummy_graph.add_edge(10, 11, label = "0")
    dummy_graph.add_edge(11, 12, label = "0")
    dummy_graph.add_edge(11, 13, label = "0")
    dummy_graph.add_edge(12, 14, label = "0")
    dummy_graph.add_edge(12, 15, label = "0")
    dummy_graph.add_edge(13, 14, label = "0")
    dummy_graph.add_edge(13, 15, label = "0")
    
    dummy_graph_features = []
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["7"])
    dummy_graph_features[-1].add_node("n_8", labels=["8"])
    dummy_graph_features[-1].add_edge("n_7", "n_8", label="0")
    
#     dummy_graph_features.append(nx.MultiDiGraph())
#     dummy_graph_features[-1].add_node("n_7", labels=["1"])
#     dummy_graph_features[-1].add_node("n_8", labels=["2"])
#     dummy_graph_features[-1].add_edge("n_7", "n_8", label="0")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["7"])
    dummy_graph_features[-1].add_node("n_4", labels=["4"])
    dummy_graph_features[-1].add_edge("n_4", "n_7", label="0")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["7"])
    dummy_graph_features[-1].add_node("n_5", labels=["5"])
    dummy_graph_features[-1].add_edge("n_5", "n_7", label="0")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["7"])
    dummy_graph_features[-1].add_node("n_1", labels=["1"])
    dummy_graph_features[-1].add_edge("n_1", "n_7", label="0")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["wl_12"])
    dummy_graph_features[-1].add_node("n_4", labels=["wl_14"])
    dummy_graph_features[-1].add_edge("n_4", "n_7", label="wl_10")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["wl_12"])
    dummy_graph_features[-1].add_node("n_5", labels=["wl_15"])
    dummy_graph_features[-1].add_edge("n_5", "n_7", label="wl_11")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["wl_12"])
    dummy_graph_features[-1].add_node("n_1", labels=["wl_13"])
    dummy_graph_features[-1].add_edge("n_1", "n_7", label="wl_9")
    
    dummy_feature = nx.MultiDiGraph()
    dummy_feature.add_node("n_1", labels=["1", "2"])
    dummy_feature.add_node("n_2", labels=["3"])
    dummy_feature.add_node("n_3", labels=["4", "5", "6"])
    dummy_feature.add_edge("n_1", "n_2", label="7")
    dummy_feature.add_edge("n_3", "n_1", label="7")
    
    prime = 18446744073709551629 # the first prime after 2^64
    r = 18446744073709551616 # 2^64
    hash_functions_params = [{'a': 6622654284345900829L, 'b': 13490758124686681528L}, {'a': 14663894821143669455L, 'b': 6439844538002334591L}, {'a': 2379686874529457104L, 'b': 8185526651052600452L}, {'a': 12967927669330969122L, 'b': 12462161476562369326L}, {'a': 12794731006915055423L, 'b': 17552924732285677865L}, {'a': 1249276043662745793L, 'b': 7989670371758500388L}, {'a': 3064986392191475918L, 'b': 12349349783191557321L}, {'a': 2534473384334947021L, 'b': 5005824705426043577L}, {'a': 16912154622565403339L, 'b': 11683889585300241627L}, {'a': 1032581858635566387L, 'b': 10914269360685178764L}, {'a': 7471181510043765781L, 'b': 3279860973155612242L}, {'a': 17704488587427593373L, 'b': 16922471305847151249L}, {'a': 16792499234352382717L, 'b': 8700104495548587505L}, {'a': 4121026640435954145L, 'b': 3276327854692116029L}, {'a': 13888905599880235513L, 'b': 17481908733172052590L}, {'a': 12431254451553104855L, 'b': 5396870450091507175L}, {'a': 11385350211508996660L, 'b': 13559896054040943139L}, {'a': 14291473694146928306L, 'b': 7925294647560394093L}, {'a': 16513833748719184739L, 'b': 16099270172953105824L}, {'a': 11779416465886848533L, 'b': 15892616741254912007L}, {'a': 9240496208648513444L, 'b': 6981722690177561747L}, {'a': 12007471701826633683L, 'b': 7845957561360406036L}, {'a': 6212354011279394331L, 'b': 7786277521262883394L}, {'a': 8295114476383850412L, 'b': 3559574395980189864L}, {'a': 2840760103249698135L, 'b': 9039618503394705653L}, {'a': 11651848732269887495L, 'b': 14155330126232758258L}, {'a': 671576611119487343L, 'b': 6809657065378728388L}, {'a': 5214669165097706911L, 'b': 13046091877741266060L}, {'a': 4660090283705429971L, 'b': 17957746711749393063L}, {'a': 1049162976580565274L, 'b': 6140551455473248011L}, {'a': 7482135423674526325L, 'b': 9194859688198993067L}, {'a': 13883736500202622856L, 'b': 5432785255208381181L}, {'a': 2848206983405151376L, 'b': 3128726294201453056L}, {'a': 13346288123623923462L, 'b': 1172444666856150047L}, {'a': 2068157107344484837L, 'b': 8837963890391637193L}, {'a': 3382042223439732776L, 'b': 14794475172608721540L}, {'a': 9597465411076234193L, 'b': 3151761442720711649L}, {'a': 7997750766485303390L, 'b': 18443268212523993880L}, {'a': 7770065253488600912L, 'b': 10185239109738382629L}, {'a': 10311731632837870741L, 'b': 5352534570416784667L}, {'a': 1164108093774745427L, 'b': 605703292256291067L}, {'a': 17040849459953732327L, 'b': 6785271306060613007L}, {'a': 7742261007483192367L, 'b': 2646325709199691789L}, {'a': 448296455842606116L, 'b': 2822233556942286455L}, {'a': 6191613261298296233L, 'b': 16342220155807948960L}, {'a': 5871823293443006412L, 'b': 5954396548803136769L}, {'a': 14960211008779721960L, 'b': 12592416079387816515L}, {'a': 13352384366934960493L, 'b': 1745188683947547383L}, {'a': 16602913703865557199L, 'b': 16108396874341914922L}, {'a': 9620534905295602298L, 'b': 18369294194323128234L}, {'a': 1287637342528393500L, 'b': 12827978415093390676L}, {'a': 9114397444229439552L, 'b': 9403770122483092129L}, {'a': 9611231489494208541L, 'b': 7627469642953105607L}, {'a': 15862715741516605709L, 'b': 7734968008632188725L}, {'a': 834180253894336886L, 'b': 3799041413703722508L}, {'a': 10526978419945216688L, 'b': 13937598156615740310L}, {'a': 18023189281969877572L, 'b': 10366020058609364989L}, {'a': 13966089523344954638L, 'b': 11316726372784188152L}, {'a': 1384861904697137947L, 'b': 411456202520680799L}, {'a': 4093127543548598817L, 'b': 12068544110729519712L}, {'a': 2756469592849248694L, 'b': 14271801654450646861L}, {'a': 2834593866484313228L, 'b': 2084470453066858666L}, {'a': 893478113626788010L, 'b': 12970886830418168793L}, {'a': 1339450879162907157L, 'b': 6268511448868851355L}, {'a': 16538002375335366520L, 'b': 12568511068628075163L}, {'a': 10511687532651067309L, 'b': 9655315220608698674L}, {'a': 4154183833167041810L, 'b': 5383963829236263397L}, {'a': 9334276538818312670L, 'b': 9712950934153078946L}, {'a': 8120096958887667937L, 'b': 2621799425318593603L}, {'a': 8304116499567267228L, 'b': 6300621556521452898L}, {'a': 11682782215196859325L, 'b': 14293469317543233268L}, {'a': 10348310926526840553L, 'b': 1012328342892535525L}, {'a': 15411992948023495079L, 'b': 11411735505028828491L}, {'a': 4997812715192147524L, 'b': 933976646724915365L}, {'a': 10298423829827254445L, 'b': 11513327761996235569L}, {'a': 856300551428842283L, 'b': 4428234123680546151L}, {'a': 11357425714271840220L, 'b': 14832625362078748701L}, {'a': 6004758452651174851L, 'b': 2474051783966305155L}, {'a': 3265396422987076051L, 'b': 59276518954600404L}, {'a': 5408732451131803694L, 'b': 14753260736280776201L}, {'a': 825540497978022088L, 'b': 1196539705150643228L}, {'a': 9439969196955910846L, 'b': 9417220117922132275L}, {'a': 2422104852532977473L, 'b': 8414687526783308171L}, {'a': 545322038667845555L, 'b': 11898847332041986249L}, {'a': 11025979740179287262L, 'b': 10505589197139132062L}, {'a': 16871410842296750357L, 'b': 8219125205865982447L}, {'a': 5799651956469692590L, 'b': 708348538682917038L}, {'a': 2521750435896001113L, 'b': 12690525723436311607L}, {'a': 1605366560863486674L, 'b': 13989431613919596840L}, {'a': 8145425794857216702L, 'b': 7067553155675677523L}, {'a': 5534971901534316448L, 'b': 1164394490268677554L}, {'a': 14171088325502590452L, 'b': 4264717265267276667L}, {'a': 17729599392032185126L, 'b': 14992343286457683060L}, {'a': 8051625486829802332L, 'b': 16007177203911090885L}, {'a': 16067211209864300895L, 'b': 14544459867370609037L}, {'a': 12684807960814431295L, 'b': 2900389010917787158L}, {'a': 12969981693232356250L, 'b': 14059735551500002878L}, {'a': 3243591966821753809L, 'b': 1201495600004953737L}, {'a': 17059071007303085106L, 'b': 7519280169100496728L}, {'a': 8251033868083505383L, 'b': 5573906535909754585L}]
    sketch_exp = np.array([
        [3212231315212479254L, 561944315875793389L, 2278629376369566256L, 477732904684037526L, 477732904684037526L, 477732904684037526L, 477732904684037526L, 551509938646874875L, 709620112319492721L, 529104058789617303L, 1183391120143437639L, 1183391120143437639L, 3385761723685491705L, 368910418120669240L, 5419078017370694724L, 7818109398891341127],
        [6392899456169673394L, 1583485532200990839L, 5016442405504589486L, 4355668166443967017L, 1224430024762945238L, 9402435764502395914L, 5653845280561902995L, 362626897521034175L, 230643618109656291L, 2136446793911238771L, 800148444556857378L, 800148444556857378L, 362626897521034175L, 1834215483633688417L, 1667333139546377391L, 1834215483633688417],
        [2380027083842839603L, 2380027083842839603L, 1440327356152416893L, 628777614337554292L, 628777614337554292L, 1440327356152416893L, 716735216679386215L, 716735216679386215L, 716735216679386215L, 628777614337554292L, 2063371306864307135L, 3411721456043329540L, 5837291279861450315L, 1961982057510033899L, 1603281641205752192L, 4833132505337494223],
        [1148063809156104798L, 7016683223120487069L, 1148063809156104798L, 1189475794086730931L, 1406840412846326301L, 1406840412846326301L, 650166230185579511L, 222908238407537047L, 481869666813032779L, 8105637802484097693L, 2586814706786983448L, 2586814706786983448L, 765079867123236093L, 7497361557311626477L, 2843633742227927450L, 71023622010497356],
        [1067034419110242266L, 2488276010931709720L, 2583458760908393618L, 6128512913863694862L, 6927743414633010696L, 3280823974500504131L, 1949912732238744867L, 2506566926162544339L, 2506566926162544339L, 3383032663938941792L, 1883804880192275704L, 1479818574651338454L, 1654696818304461593L, 1883804880192275704L, 1144927210695959744L, 979457396451145915],
        [2105772965290926337L, 2582486923558047462L, 4919907345183158620L, 837001527739026395L, 988045933144552516L, 158377746319053960L, 988045933144552516L, 6765976755669135024L, 69276103066260504L, 2954220264045860362L, 1056143778624274268L, 4134684481415011018L, 402679983182256921L, 234883536550462505L, 69276103066260504L, 1162236242856097712],
        [265434032719416858L, 193780583036272069L, 10097521025467551874L, 4399291757414727519L, 934530210490633774L, 5595948653966178882L, 396802507071052678L, 1506308816227038913L, 9806056712682326048L, 1562610720551739517L, 630198565314471246L, 1562610720551739517L, 630551894193579040L, 3980517734358222304L, 89920528044501998L, 89920528044501998],
        [5637801698670954158L, 6069565014266432757L, 1727142859458722408L, 3381717731052295294L, 5948308057925365883L, 417276062948538743L, 1755633751731863646L, 1755633751731863646L, 1755633751731863646L, 2549376861876316227L, 421561596234907804L, 4763111002850323552L, 4616445449709769553L, 1719538856864912593L, 5182544319027117622L, 3028912091723453159],
        [583133726298836420L, 583133726298836420L, 2421796621142771382L, 1127021416791125868L, 4114855544159091081L, 5425662591923277493L, 601955867051608447L, 3583380262897636116L, 674858828331394412L, 4114855544159091081L, 3965151350838172236L, 9438425295839550267L, 5615229532092429425L, 3965151350838172236L, 5280702419741655810L, 3558966627285774668],
        [1495480383745487568L, 2903731767447270025L, 1970027806035305372L, 1591077398486659718L, 876548986513201010L, 1057570011053992448L, 1120589775484416257L, 677287643871855304L, 878387048100904999L, 3294827737355280705L, 2031253404595793740L, 560400871222132964L, 1976672961833692032L, 298599808865986328L, 2862226897705482404L, 5420307616267104467],
        [6228991791980129718L, 3206438641203189299L, 4809198276293894146L, 3206438641203189299L, 6926895431333187723L, 2642305659240301044L, 262603344175195785L, 1384652822675873842L, 711033806766780572L, 4138692423876213275L, 3851896394692872110L, 1523749258809759348L, 1458651584777955458L, 1523749258809759348L, 711033806766780572L, 259390157944737998],
        [4694512676896401719L, 3372244420450986666L, 942855424668359477L, 447256719951895910L, 1119979283681562078L, 854267066265586294L, 869396432794020685L, 6806544771625988875L, 666082432061091440L, 9077276726495616579L, 483131146546428467L, 483131146546428467L, 483131146546428467L, 107839137942885890L, 1151611454623664345L, 6054156342561100104],
        [6138723201997277160L, 1076094735503865795L, 3980539645412843864L, 1240377025896707908L, 1240377025896707908L, 59094718808012796L, 2351098506837620800L, 4059025567286270990L, 1095828599551505209L, 1240377025896707908L, 606464470152878491L, 3189330993274240237L, 158282268882033622L, 2225925349485875170L, 1095828599551505209L, 1851163119883844904],
        [1996623864127838751L, 5859710264054429L, 5875013939424412748L, 1456880966475986407L, 2459692684133320510L, 635489043613566824L, 5859710264054429L, 960151491692491814L, 960151491692491814L, 2611021306601395633L, 727576939075910554L, 5359552490411817198L, 2718168886553531533L, 2956888762213680946L, 341522634866826796L, 3722262277002710428],
        [7951586003477959374L, 4313276680249689237L, 5030210553124143758L, 2334772297831313378L, 793096155948926227L, 4594770974120093150L, 1713591848353425675L, 398775366732418204L, 6137124886633652619L, 1764229384059572482L, 480258088973855575L, 480258088973855575L, 480258088973855575L, 2598304013711467516L, 1275005677327338903L, 644852543213315594],
        [5117629992250141589L, 9585932974758086929L, 6046547550173703118L, 3345828228696179163L, 3345828228696179163L, 5833370087379857411L, 11574423317812407L, 1300459543952322351L, 1300459543952322351L, 308644389235247482L, 3380487701856257474L, 1870195923959854785L, 3380487701856257474L, 205218998897165381L, 7121970664515455408L, 4938517152502421295],
        [459284633522271461L, 1129669508331366202L, 1659115781496038344L, 4629568729730658283L, 4201381284885993557L, 2364111283629901702L, 623068686710591496L, 6269823910517965265L, 2813987773733987202L, 911329699591711861L, 2263426126717531852L, 1251612392269466870L, 2263426126717531852L, 1703821835940405986L, 1994285161391278498L, 5907623336897264810],
        [5817695846038680007L, 2026029561805696730L, 3380583633121945178L, 991664641320350544L, 3541557040653764166L, 3380583633121945178L, 942153598149284794L, 4304348346320952998L, 2842844438889492771L, 6059630588767835087L, 5466797654279939212L, 233454054716725179L, 5558517091371480032L, 141389888299122114L, 1115682835171048115L, 1115682835171048115],
        [4838912731743679061L, 5975634270635494427L, 550946163542920334L, 1301180266876331025L, 1795255647729557932L, 3904872468477972701L, 2428150731490361828L, 1338510147553008874L, 2428150731490361828L, 4305128228919848087L, 4591375977248465009L, 4684095671424880759L, 1085052576548544861L, 1076560245796796432L, 8561954133005185799L, 8916647715713525117],
        [646793872772631131L, 180928412837114595L, 2294014430138678536L, 1548413245904317302L, 3535078017491938390L, 733325222390976662L, 52575561554478640L, 3517316075001128368L, 84423536911776346L, 3758012699779391434L, 2905113251953792068L, 3758012699779391434L, 2494819552734176272L, 633757752367253925L, 2598800560623012376L, 4796860830496928484],
        [3906335381617105742L, 3906335381617105742L, 57090645636539547L, 1928495085710467410L, 2230549513190530170L, 671047577898407053L, 1246448457173570427L, 4728017562089128026L, 57090645636539547L, 678840211923145740L, 2251813423936071696L, 1393504424930417187L, 717546304205612867L, 3478340331157823187L, 2230549513190530170L, 3636029230340843415],
        [1573887295533570956L, 770471733286651446L, 1573887295533570956L, 1150092737150240348L, 65918078545427690L, 1732312529725886327L, 770471733286651446L, 4354861905513574100L, 4354861905513574100L, 1150092737150240348L, 2173753581455067527L, 3979357898895693410L, 17006302002391232L, 1564186149044837099L, 2006793507364730305L, 1564186149044837099],
        [8416960914707890093L, 1947067624999969667L, 340167194178098314L, 4707034995610937549L, 332208852988373337L, 340167194178098314L, 4410490638128547373L, 2612280517533557729L, 2310127730203630344L, 4934911548967805021L, 4934911548967805021L, 3261206137551219031L, 1889275761242544491L, 3784557668039524702L, 9166278002078994893L, 1063698268470563616],
        [525254825926011220L, 4811962671494207458L, 2523587608538707457L, 6665546709507008973L, 2734349036891815519L, 525254825926011220L, 2311687892838511283L, 3634687820452109443L, 3694270414012508784L, 7807776710843086917L, 269300146150155085L, 374824009508255770L, 2645899664857816715L, 2888855400061497897L, 2734349036891815519L, 2888855400061497897],
        [518958705329458945L, 518958705329458945L, 900082917652056538L, 334958070315770745L, 334958070315770745L, 334958070315770745L, 315185420565806809L, 2656954926363737401L, 1415335193881427372L, 315185420565806809L, 315185420565806809L, 315185420565806809L, 1232524400737735579L, 1232524400737735579L, 514339403211706972L, 1232524400737735579],
        [2748926570526304226L, 2442653306524977754L, 2336305643354480435L, 1743547698736543647L, 1743547698736543647L, 1743547698736543647L, 1743547698736543647L, 8772525810523290081L, 842586948213429235L, 6420529719061280031L, 4301693108707176500L, 1365370791815061805L, 353422997277841786L, 353422997277841786L, 1344960277126717634L, 353422997277841786],
        [1608834374947473880L, 1608834374947473880L, 255793835446036695L, 3211964660692073362L, 2637901902036301342L, 255793835446036695L, 1075562583989543748L, 3904053992084386940L, 1142814531129008669L, 5953201358955070830L, 2731612379960931906L, 3981080594769063189L, 1408813554293988080L, 3904053992084386940L, 1222814883547943404L, 1222814883547943404],
        [2321516635941293731L, 6214900483933535364L, 276156167158450673L, 6214900483933535364L, 2583561079030163750L, 2430465567683377519L, 2143326116147661204L, 116284087129049895L, 116284087129049895L, 2163079208565496027L, 2163079208565496027L, 2163079208565496027L, 116284087129049895L, 2928274181558267298L, 4241467320533271080L, 2013346062569135205],
        [1336145143178514137L, 367396544773064476L, 682124355336018037L, 3182262145004332346L, 156997398821903232L, 682124355336018037L, 367396544773064476L, 2793161348277015332L, 1624363406510348891L, 6662274362224516853L, 4677201379610655492L, 11095311133825340183L, 2765827330493130044L, 714882042914548524L, 2408586197453223912L, 1436486942704613725],
        [5753180120021085703L, 3400596193830594712L, 5661117368293774418L, 4669164867437969245L, 653399064526632655L, 8717070377364636647L, 1071237531085962639L, 5849778414564533657L, 23417725526784324L, 1596663267527210904L, 900729553727882408L, 1213121353718094230L, 1288842245421897487L, 113153628718969529L, 653399064526632655L, 1331380072078575394],
        [4303952555596609841L, 4303952555596609841L, 2614782437933599938L, 3972717516351987296L, 2236230633527266930L, 4370927476866088296L, 1044374384951165101L, 122065417082131052L, 1861433171802133754L, 1434676423181318824L, 657364372225722980L, 2181817660374091326L, 2105505597171770028L, 2821238546939541581L, 879593565358668173L, 34529005180863293],
        [4043898334982908974L, 4043898334982908974L, 2317836868662184515L, 4665718873349423886L, 1273044364900202329L, 2317836868662184515L, 1593675689310388707L, 130760949195796440L, 1369500373630796089L, 4570147390716145211L, 703817542779500032L, 3285087537455635476L, 97180291469606683L, 1674135572116784434L, 1273044364900202329L, 2449882132052604457],
        [3875105187449613744L, 10685522126705124309L, 92298392700929945L, 2722428496990361901L, 1683445422174791202L, 92298392700929945L, 152327496058979248L, 152327496058979248L, 152327496058979248L, 9632204010900743555L, 707640060803459527L, 9632204010900743555L, 813214658004496519L, 360145244647203368L, 1948195539195707536L, 4441595982949002499],
        [781151083305669329L, 781151083305669329L, 1350897875378058326L, 141426929910401485L, 141426929910401485L, 2754817995262213196L, 1725078674971515139L, 1978215510892855847L, 1500580213485647670L, 141426929910401485L, 928662608914053091L, 2965806014654816433L, 469343623085959717L, 928662608914053091L, 720407250307796281L, 720407250307796281],
        [109802806271754772L, 369955478008444336L, 2147698310150686299L, 1293684836685302455L, 1293684836685302455L, 109802806271754772L, 947178877949188395L, 2172969242045941232L, 2079896600687912790L, 1293684836685302455L, 3867722027143566157L, 3751038173327981060L, 452936034884640916L, 1840683666132026439L, 1992258661993787064L, 985125787655319015],
        [4549839291763896421L, 1246538094033422219L, 8422873625216616347L, 1030019012224006326L, 3472572602556255158L, 6647919324471826719L, 3883373789138599152L, 5401962931832493142L, 967244044938825697L, 689293449257803445L, 9840918995551853269L, 3411821747288146404L, 5401962931832493142L, 6240155241428721225L, 597347544426044780L, 2791089133124309328],
        [4840286870364659989L, 5741256305065493468L, 64095878014042923L, 288506302892527032L, 288506302892527032L, 64095878014042923L, 637906627117068546L, 6947958998266226597L, 74507702256858868L, 288506302892527032L, 7234509254483332084L, 288632228438443070L, 1964156414526455479L, 1964156414526455479L, 9980243097429405581L, 1524716964798791758],
        [12269461746988906020L, 999849693716509371L, 1353638882278880121L, 209033595912741843L, 1763548787245710523L, 1132958776580628438L, 683336128392583251L, 4245650063960845711L, 6775098223075616052L, 683336128392583251L, 404978926011842728L, 404978926011842728L, 404978926011842728L, 1936225028357028504L, 2059390034266274759L, 2773580303593109528],
        [973077117287124039L, 27641403695827073L, 973077117287124039L, 2579953804125455315L, 2579953804125455315L, 2579953804125455315L, 926371425879180778L, 2398858692977756495L, 1280736514867814429L, 3685040438670006276L, 10837716362649114781L, 10659121460171939292L, 2398858692977756495L, 177896458423605514L, 5040494274205037306L, 1320054932399186577],
        [2290822711603261698L, 1104486995102853577L, 1494147465069978916L, 151583723836556489L, 1442002195406358753L, 1442002195406358753L, 1034890296945751259L, 803228193378185261L, 1494147465069978916L, 3217596483076964215L, 1560758612451109374L, 1719737868642969277L, 3967937721837410038L, 1454699565247296055L, 4329903269312569415L, 2254474403045251899],
        [1702310004976521405L, 3673800415000142988L, 3165398370413311858L, 3170638838026018976L, 4559328594807268362L, 1702310004976521405L, 521784759600578618L, 1624241680495661532L, 2866915026405597273L, 558530034285137019L, 3090391389809897149L, 4064164765102358316L, 915890952380068659L, 1624241680495661532L, 7407159996143704676L, 1732293710987268790],
        [4776164060788222292L, 1343495572328618536L, 2836288759035251640L, 4762029061501074587L, 5552075798115012773L, 4776164060788222292L, 1338712810102879214L, 1967387816538906259L, 1907088959948424813L, 2722366610316232236L, 1471661462373120602L, 3657631079440656416L, 3507593713996596466L, 3657631079440656416L, 6284644437461563781L, 5624788654966677220],
        [3445279496143869726L, 826191579554767051L, 3605817394304307099L, 123694635888451931L, 3544346485567663975L, 5690475079345095825L, 2311492478866954634L, 2879508292166290685L, 2603184935277848280L, 3120253526419857161L, 239453013251707460L, 2559304642750475236L, 2879508292166290685L, 6575212293308486868L, 2860379700329409831L, 2603184935277848280],
        [1734246257765703359L, 8742503604517023238L, 2121931462204977440L, 1519442759577603419L, 5477881062361401382L, 2693847189178537952L, 1519661899523685960L, 3057545171106766611L, 3057545171106766611L, 3329625668644913926L, 1849860567098353944L, 277187874093215535L, 2309295884875409423L, 277187874093215535L, 5542695913657147836L, 3091215675921607890],
        [3494478734350956288L, 2340555757870984776L, 5768956578073809799L, 487699179029582259L, 304446200123572281L, 487699179029582259L, 71963211086085856L, 1768981804445450799L, 2449113151510035622L, 3108790783648872554L, 3108790783648872554L, 3108790783648872554L, 4185216750472519447L, 5063193354362417223L, 863274475747104113L, 863274475747104113],
        [4352512091594908082L, 2074893393515974076L, 296186012400146078L, 592342103908322129L, 1824829545403358290L, 2601227862181807684L, 806753582525379584L, 893771390153464063L, 1307368516688778401L, 2245726511625424452L, 1271819168704588303L, 1460657073107661792L, 1720122569898222996L, 1271819168704588303L, 2306022321530410774L, 2606061036592531596],
        [1750381236991228702L, 4077114653762970088L, 1185452982714130507L, 1193638031267851112L, 1193638031267851112L, 4164473130581482488L, 2303053672660734629L, 5550292946464464962L, 1185452982714130507L, 87605521464803427L, 6190249669629393619L, 6303011430464260971L, 916714334654596742L, 916714334654596742L, 10034135852434512905L, 916714334654596742],
        [8723655307782282742L, 2283676366585304509L, 2449957576706509691L, 4664999185991015625L, 1463617575300899223L, 4566193557802351380L, 512152902694786463L, 5808362008877606047L, 2449957576706509691L, 1590331738922991604L, 90566157942630822L, 984291872459337746L, 984291872459337746L, 343276137604478763L, 2195182752645365758L, 741159070542550157],
        [4923297060498435711L, 220008904535646715L, 4923297060498435711L, 6137054790155234029L, 5568886539498987605L, 2739039905343587578L, 1488821607354077000L, 574086712170141951L, 250789348954056732L, 5674985569728999479L, 614144455256252659L, 1407625999261540557L, 490984113699933408L, 1305265556736704041L, 5847639007899154050L, 1305265556736704041],
        [215198256725254123L, 215198256725254123L, 543815304784390776L, 1050942275309209909L, 3063308937827590275L, 1618717315577520398L, 366150148850564852L, 1133180320799890253L, 480060159300862722L, 3475036444807667330L, 99239020503559683L, 2638890922458065040L, 1133180320799890253L, 1184682241072623265L, 1877443303446073940L, 4878394626967290457],
        [2752612832473498030L, 4550242359309593841L, 4574476540370838819L, 207339265523758023L, 207339265523758023L, 1685476214416878703L, 159660255028403596L, 234924678049408189L, 832154620721008444L, 207339265523758023L, 1129315940693971221L, 3101484180791372055L, 223846810466261296L, 389752077409642736L, 4041282141490377102L, 1887177586790312734],
        [2737599025944534406L, 516816881590490374L, 10937644401265504399L, 516816881590490374L, 1426335287677513400L, 596840360674763712L, 2086124047536550302L, 798469936403222643L, 1331747946576448914L, 4985535344170287459L, 4662684783898174985L, 2783358732815454175L, 4335179232321388910L, 2976713503869271006L, 6435480734162975908L, 1331747946576448914],
        [416313175311711279L, 416313175311711279L, 431462304659411711L, 1084934112572915221L, 1817544962918161054L, 191260409092388787L, 77504600693417293L, 2392802538333916327L, 3176278452401411131L, 77504600693417293L, 77504600693417293L, 77504600693417293L, 5601143102885574912L, 1202646783469568652L, 218558533984334505L, 218558533984334505],
        [3361423008985911487L, 622904120118730314L, 2168119627154002400L, 558889246289488870L, 4176769001797431205L, 2168119627154002400L, 261820718835200674L, 2150287628702328572L, 2150287628702328572L, 2444885276905236871L, 242485679735642721L, 3319189849106032274L, 2150287628702328572L, 1793560508977390868L, 2928987807224142391L, 566739414791266360],
        [189469628074377784L, 1203971367930963869L, 189469628074377784L, 2492839989109817289L, 2658553571906866584L, 3314473062106621396L, 168120850558054392L, 2611566782218992834L, 1448546421063676418L, 2886903152166739454L, 39535557625009467L, 5919677011182160456L, 2342173105821354769L, 2887304523857615394L, 2658553571906866584L, 2966134269354395869],
        [46859634100703311L, 2727226407805927707L, 46859634100703311L, 235783284762502646L, 2109008163523680423L, 100363748581428916L, 171780511820908003L, 1178722793313084029L, 1178722793313084029L, 4100143493253875359L, 784149098956196345L, 613061776757216574L, 833005081738263346L, 613061776757216574L, 2109008163523680423L, 3500525977968379758],
        [2796872457739744327L, 3802205982089928877L, 3917286519350553186L, 4092969979931232371L, 2478866026304002478L, 3708332342972160888L, 962898203765616853L, 52475738326776850L, 921944961605340533L, 4171024974318930643L, 1992449635682512684L, 1992449635682512684L, 919432614997182888L, 52475738326776850L, 146187656632979925L, 146187656632979925],
        [3117979066181027423L, 6675041491730504822L, 2842975037719167371L, 1626026711399467985L, 142719390842126479L, 385416234913060558L, 333355011955850248L, 1138834658278670121L, 1138834658278670121L, 678872493148425668L, 8750866057245784557L, 3122038842647826809L, 1138834658278670121L, 3411842022364573557L, 3967893310339879713L, 1829907828683319374],
        [9750971652511864521L, 1393294891199574597L, 3850548304078670425L, 1393294891199574597L, 2984130786820741692L, 3693998156965792302L, 749704059314855946L, 2835760144326255291L, 164546784977910039L, 8306749390912581335L, 6479664960161312191L, 2578747188415037035L, 1640254367734683497L, 2578747188415037035L, 6385115006763896265L, 1778620887707779122],
        [1327364817890971468L, 5580574693238107212L, 3995833144000994600L, 1628874831541138387L, 1628874831541138387L, 1327364817890971468L, 7199755514362789591L, 2366804828923149424L, 1759625146338808517L, 103214553176547415L, 900800356337544367L, 1556047749399600528L, 5311326136658504553L, 900800356337544367L, 1139431899812597190L, 1077528080681410583],
        [476129671634098369L, 2008898548528912742L, 5783127733654706052L, 3409586423191977759L, 3963567049698535916L, 476129671634098369L, 24022659636000383L, 1649631115428298702L, 5481462303059044142L, 4190619222704521718L, 82721737164484400L, 4230424568222920921L, 520637936529397913L, 493044344562852423L, 548961020037181697L, 6587124791199541],
        [3603445021650751876L, 3603445021650751876L, 824917992988121127L, 1488232428368893411L, 4425594291530622739L, 3405008070163811233L, 3055574081696972361L, 290438899635826341L, 824917992988121127L, 2189484596949164282L, 1221584108075212632L, 3533427451326749189L, 381356127974192187L, 381356127974192187L, 4378800961096136411L, 381356127974192187],
        [2338340683482539211L, 4020190017064122897L, 5016195015656746425L, 1738273827451215065L, 2414814481098846412L, 4875309752260815363L, 1512876510708720448L, 4489611061181444937L, 1013252421280031734L, 383655166688000607L, 2889227294072377255L, 1038018125156952172L, 1712622740702093163L, 1038018125156952172L, 1464658019912424575L, 1657794624286816183],
        [4054924078453373090L, 3762136453450699169L, 1310304941104643850L, 733580044218424677L, 2247781982846257976L, 3318253818799582483L, 648699240363363383L, 1744779119120462567L, 146893182328617519L, 648699240363363383L, 648699240363363383L, 648699240363363383L, 1744779119120462567L, 1045704330843954496L, 6910462024790550844L, 1067179292968983446],
        [615544420735290737L, 4209462047186422651L, 2533865307842478589L, 501647896480266721L, 4511102437546809368L, 4511102437546809368L, 462852820982957532L, 1489285969172019138L, 900530289193506539L, 3329713340179577062L, 2727994965753072442L, 2727994965753072442L, 128169073970299027L, 128169073970299027L, 4388295589355463821L, 128169073970299027],
        [234516575287522467L, 313247142503036375L, 234516575287522467L, 313247142503036375L, 3177852782382123848L, 414642093444857520L, 1001274887930461001L, 9006824300568599007L, 1538825843448493897L, 1255935109224905982L, 1255935109224905982L, 462434262826851688L, 1339549345157701555L, 462434262826851688L, 4850498749422718683L, 1093923180355447698],
        [78018379968557378L, 110970914215318175L, 6064462225308965391L, 693030190761205863L, 4827478543425698804L, 3530462353528990081L, 613813925191816706L, 2443024191887428158L, 2443024191887428158L, 1652085348833304316L, 111949432770406438L, 1652085348833304316L, 325823173380848695L, 337080638914462340L, 1145782183675287830L, 337080638914462340],
        [7940253820688480095L, 1125692027879710625L, 1167631947846968593L, 2582179685988205351L, 2582179685988205351L, 2582179685988205351L, 1176327324574672419L, 6379711144734338474L, 257201160636605525L, 5230136923558484355L, 5407208061300715084L, 4953476054964793872L, 123931532892348551L, 2166467684791131456L, 7656926336857832760L, 1429754879452194882],
        [2184471028692193859L, 821082836411647981L, 2722697736729395315L, 3341517750709489443L, 4167379055898890272L, 4915622131718706734L, 1123359274915656258L, 3199471963223596435L, 2853105075636958160L, 1123359274915656258L, 1123359274915656258L, 1123359274915656258L, 1207090717327714727L, 3199471963223596435L, 1908288934154215355L, 3238841117598668533],
        [2840121177778198003L, 1506549776005532057L, 3754346534110366015L, 1429218160582749996L, 3034815700852424353L, 1593397247705314827L, 861207298771609868L, 746707263417842973L, 32734607023859053L, 6557195039941878868L, 6561420105509165129L, 6561420105509165129L, 207805044143724270L, 1328730431538662161L, 4106524771696366796L, 2793515534403805260],
        [4519139487108203966L, 108203212572840097L, 2597493911897062696L, 108203212572840097L, 181344439639298354L, 3352903398701406450L, 1212466547715746696L, 4033179334198883218L, 2597493911897062696L, 8497589213935945206L, 151555204309735560L, 4416503556500407342L, 582011727289757583L, 151555204309735560L, 3701825892062508865L, 1061046339453465010],
        [3166617490401114720L, 1264387073083086487L, 4259607478986024217L, 1502526195836704661L, 316087826871443308L, 3166617490401114720L, 1264387073083086487L, 5058824834340967900L, 2577731074812524290L, 2939524930053583247L, 1166790786511142860L, 4423958432278630978L, 940225978123467621L, 940225978123467621L, 7757949347272012779L, 940225978123467621],
        [2825969982564383341L, 6709336127657915766L, 1154822390318605844L, 3859996805007261968L, 307397865936759562L, 817337118533595930L, 35627691607262096L, 1307691526697493282L, 602060780360761933L, 327027209983031085L, 8412432449170846014L, 3015127143916057727L, 977677535694011094L, 276943581632118876L, 2537692650015985461L, 300540833888545994],
        [353444031079673407L, 2104846997006156305L, 744618474499906605L, 1891532923107993461L, 367058241320772722L, 744618474499906605L, 623482032853025968L, 3562594651457469460L, 978636211100855847L, 3483297425085795896L, 102509281083900616L, 102509281083900616L, 102509281083900616L, 1305014256158951047L, 5498442415922255520L, 5568769911331324036],
        [1963953723480490585L, 5482868398557719073L, 6127878956573522711L, 2832634171918218099L, 899257876069256357L, 771011211439600414L, 1742459624924840003L, 1365021651560305118L, 1365021651560305118L, 1164053498378755754L, 418874623323317696L, 694450408369075897L, 1365021651560305118L, 4156432425319657009L, 740788530817299551L, 1329185892814198847],
        [651615333025934961L, 651615333025934961L, 3072085908173211339L, 1167277713366707578L, 1386406683880278964L, 1253859958213204916L, 736071402408752011L, 10620755376009965003L, 3009975377172264179L, 9129908147904817254L, 4973262334111404571L, 1206825885605723741L, 1343502503148966214L, 870072928818033726L, 5560647808033400666L, 1360504206495894907],
        [5104359026868352634L, 3636686181181095097L, 960946604007887468L, 179698706544995485L, 3267907928598496839L, 960946604007887468L, 4376163212768885712L, 5800642864081064307L, 2686355471768280026L, 5597352447641259005L, 823885301019151678L, 5597352447641259005L, 2769364183665997634L, 997082307694181046L, 648193064919892048L, 2015369656176041726],
        [5999600915400784442L, 627506738395431687L, 716458860825710081L, 2770580814154277752L, 2511727359681755957L, 4090379430269328942L, 17262191081546420L, 1043583421912961672L, 1312888209713262675L, 6507732649774096743L, 6299025528974007745L, 5888580996387892443L, 6944377784384225079L, 2190631214594719300L, 9148719565587843L, 9148719565587843],
        [1477529392039085588L, 1107651010902055114L, 1477529392039085588L, 327104061514538921L, 327104061514538921L, 327104061514538921L, 168018374010365366L, 1391979848719143121L, 1391979848719143121L, 173494486607407736L, 665645072203832390L, 665645072203832390L, 1391979848719143121L, 1856550911902241726L, 1427964864629231043L, 1856550911902241726],
        [678063447635808667L, 1015222882288115327L, 678063447635808667L, 1011808859611382651L, 1011808859611382651L, 1011808859611382651L, 144516782585677221L, 836153173811760187L, 220202491969723076L, 1976992095839568165L, 2844276296579546716L, 1776746570134109729L, 3894164547232584929L, 5171584194304057670L, 4254510371910991112L, 220202491969723076],
        [8825315275049935334L, 992820580932475464L, 2417494542788072121L, 7873233032830109223L, 2148168064943177618L, 5331874717818554040L, 1454192699772767063L, 1763270764272695463L, 1530497671057542985L, 3905929639181002848L, 2090516900562993910L, 434107055986636764L, 308803720263638386L, 1763270764272695463L, 1182129976221432813L, 1182129976221432813],
        [2485273279369518745L, 4403030389518519587L, 1300824746784819715L, 615117468775288840L, 615117468775288840L, 2485273279369518745L, 1236647465945202479L, 1546478483710915703L, 3240912247948953504L, 615117468775288840L, 677695691055313668L, 569054926293400491L, 874539683089733518L, 569054926293400491L, 3240912247948953504L, 874539683089733518],
        [4420567840077185010L, 3337885175285833729L, 5718617858157148767L, 1634467334954310232L, 1634467334954310232L, 1634467334954310232L, 1056440576668971352L, 11545455767277141102L, 633487056267640706L, 5773124543793823406L, 2200212697856468678L, 4072763164122996514L, 2589483121269515001L, 944577461838623453L, 4834909956186480797L, 9855308649498284074],
        [2420563751276011582L, 6895274768277761231L, 492508367383596668L, 1619587290657738962L, 3661323171183233084L, 492508367383596668L, 319659737735163532L, 336290968529119233L, 1354061513880227878L, 1492539170140531961L, 1492539170140531961L, 1492539170140531961L, 2619664478860001458L, 336290968529119233L, 2681261299077693873L, 559714633439041806],
        [805992562121213904L, 920081951091783371L, 805992562121213904L, 1979642086522970575L, 29138820863755311L, 1979642086522970575L, 2642568895125050508L, 1281079972330519603L, 1281079972330519603L, 3462597851457511947L, 4550790286578399926L, 886783270458310496L, 1281079972330519603L, 782998264794779298L, 29138820863755311L, 2798248719426830649],
        [771492927676627751L, 1072288396356094824L, 1937216661076829118L, 2970043362110624843L, 2970043362110624843L, 731640036022891016L, 1072288396356094824L, 128236311180684078L, 1038615484400956374L, 2971893791735875225L, 632312738802650113L, 632312738802650113L, 632312738802650113L, 1782118339819518526L, 3787514022516025453L, 4261422759778490595],
        [3928498464746605579L, 464921889233899787L, 3928498464746605579L, 1557817648069803024L, 1525311275283096993L, 4170157216750873442L, 953096344238356919L, 4800837143064428597L, 1087414727118206198L, 6016382118512922672L, 7608264572578102071L, 1334798380054009202L, 1050619774255571023L, 305918802538877309L, 1729785532134407232L, 1050619774255571023],
        [2731085951740351431L, 1634035021215240926L, 6193025214515521091L, 4509696378999425967L, 972806661664042693L, 2731085951740351431L, 1692789396727191368L, 8048963630568449L, 2463749310538340543L, 1384243044931505980L, 185130234844370837L, 11373408214613156L, 1065292588753928343L, 8048963630568449L, 3541920883179534677L, 1065292588753928343],
        [1706071826682155332L, 154575866078228121L, 2077593557111182535L, 5793105723231425536L, 924554992457664693L, 5631304806590667539L, 3123395371057887430L, 102871103479852716L, 102871103479852716L, 1689659263590439434L, 2230934599979118906L, 659747765845924370L, 102871103479852716L, 659747765845924370L, 4390280647365037157L, 2065373678451134133],
        [1616167766196233943L, 1616167766196233943L, 3760066889650807339L, 3190361244893256393L, 4771915192880928269L, 868459171432622978L, 174535588706096243L, 1914620658716856257L, 1914620658716856257L, 1459246165673921647L, 1374870787518189274L, 627947633250047639L, 5365020272687932282L, 627947633250047639L, 3229249273124885274L, 507841429593616423],
        [8253928543464437670L, 1601620393269891726L, 216884865084290323L, 573716527615627923L, 54031452916878600L, 405490624119448735L, 1200713027109766841L, 1945758031867660375L, 216884865084290323L, 573716527615627923L, 5993794917643065880L, 5215450267580485614L, 3641481938600050717L, 3403971314507102482L, 4012662881515768434L, 11602799159886362880],
        [2767289658102412299L, 2046769374310239522L, 2767289658102412299L, 2644179149835654340L, 2968632709253884848L, 4757789847404632857L, 1107582549460643493L, 2330171418402165324L, 2862919561588749227L, 2027987297163202684L, 3453451641641933434L, 969910520952057960L, 2390136414556667447L, 969910520952057960L, 6064103375649031977L, 2247253301147965675],
        [8602502094161654680L, 9421664277548204304L, 1324658709015794225L, 10226031377288809467L, 436344436498302106L, 184499636192450665L, 5029355846873717027L, 542094311041256431L, 3640135564498970999L, 1414457271182515992L, 859855678213017604L, 1424395834502963842L, 108553054296858338L, 859855678213017604L, 4430201714610092622L, 3770502470314256351],
        [2188999884902479037L, 2222523316276679419L, 139708318807517581L, 3429701348252351232L, 983458039620922654L, 139708318807517581L, 973335619381718225L, 10351355390576944364L, 4146532017762479373L, 1609735622895192021L, 2118579032228122989L, 3196538619538155020L, 3869075836498052373L, 2118579032228122989L, 4086948141275018397L, 4086948141275018397],
        [4400102880108232385L, 3207441121742822144L, 4400102880108232385L, 2350669129213811919L, 112400080436029113L, 715230480305458171L, 168590922625534564L, 2291013629040241431L, 2639721105640355199L, 168590922625534564L, 168590922625534564L, 168590922625534564L, 2639721105640355199L, 4117065245956811322L, 8407886956681534087L, 4117065245956811322],
        [1112629871847593521L, 1731957756298245313L, 1997475827473583262L, 908470451295105040L, 908470451295105040L, 908470451295105040L, 908470451295105040L, 3366480564486638804L, 4002983838349295670L, 4608441071133966382L, 8210057766779756167L, 56148307578749775L, 4002983838349295670L, 1952007868924454932L, 2828013402175756261L, 1472887364189049483],
        [1014567628079686384L, 2362265721664048345L, 2066342213446173505L, 794980209379747719L, 33193422108674644L, 1042963404683638084L, 784348917886556825L, 784348917886556825L, 784348917886556825L, 9104584512394712570L, 3574839525191213042L, 3673459325427306262L, 3279423343914731038L, 3279423343914731038L, 5448369719775548455L, 2870522273736003935],
        [1849960212949384533L, 3040588817944950109L, 8697975007241342023L, 5600382186191717263L, 5600382186191717263L, 19039016076292189L, 1036976346603084406L, 5621725402093660658L, 319815764378660392L, 9721472874775516325L, 130791360338920171L, 3670573460265105591L, 4142644042321831918L, 765346082826364744L, 1839508275745389241L, 319815764378660392],
        [12659297984623150188L, 953018463395560185L, 4736715172977110000L, 610979262425151380L, 1052389168138410338L, 1052389168138410338L, 1052389168138410338L, 345304905266708255L, 345304905266708255L, 6810194274099931679L, 3832663819256282034L, 1244355307002510440L, 345304905266708255L, 1244355307002510440L, 10693184065027312801L, 1757387488631962502],
        [3982414805374005067L, 4012738696133345958L, 3336540489874697274L, 3562843537598479848L, 1666102225900320670L, 3562843537598479848L, 4544338418306595101L, 5769719795973673059L, 1389716937533315231L, 4545542735324994222L, 4225270491885971256L, 2878848129896428490L, 1996009639543554464L, 856802842380014125L, 1666102225900320670L, 951227290531520611]
    ], dtype=np.uint64)
    
    def testFeatureExtraction(self):
        labels_lists_exp = [
            '0', '7', '8',
            'wl_0;wl_1,wl_2', 'wl_1;wl_0', 'wl_2;wl_0',
            '1', '4', '5',
            'wl_0;wl_1,wl_6', 'wl_0;wl_1,wl_7', 'wl_0;wl_1,wl_8', 'wl_1;wl_0,wl_0,wl_0', 'wl_6;wl_0', 'wl_7;wl_0', 'wl_8;wl_0',
            'wl_10;wl_12,wl_14', 'wl_11;wl_12,wl_15', 'wl_12;wl_10,wl_11,wl_9', 'wl_13;wl_9', 'wl_14;wl_10', 'wl_15;wl_11', 'wl_9;wl_12,wl_13'
        ]
        dummy_hypergraph = Hypergraph(self.dummy_graph)
        features, labels_lists = feature_extraction.extract_features("n_7", dummy_hypergraph, r_in=1, r_out=1, r_all=0, wl_iterations=4)
        self.assertEqual(labels_lists_exp, labels_lists, "The wrong labels lists were computed by Weisfeiler-Lehman.")
        isomorphic = all([algorithms.isomorphic(features[i], self.dummy_graph_features[i]) for i in range(len(features))])
        self.assertTrue(isomorphic, "Wrong features extracted.")
    
    def testRabinFingerprint(self):
        dummy_binary_array = np.array([1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0])
        fp = fingerprint.rabin_fingerprint(dummy_binary_array)
        self.assertEqual(np.uint64(9332362780641026048), fp, "The calculated fingerprint is wrong.")
    
    def testShingleExtraction(self):
        shingles_exp = [
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),4),1)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),5),1)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),6),1)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),4),2)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),5),2)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),6),2)"
        ]
        shingles = shingle_extraction.extract_shingles(self.dummy_feature)
        self.assertEqual(shingles_exp, list(shingles), "Wrong shingles were extracted from feature.")
    
    def testGetMinhashFingerprintNaive(self):
        a = int(6638699916324237062) # random number
        b = int(13296106891814937365) # random number
        h = SketchMatrix.hash_func_generator(a, b, self.r, self.prime)
        
        fp_exp = np.uint64(13099543911338852352)
        fp = fingerprint.get_minhash_fingerprint_naive(self.dummy_feature, h)
        self.assertEqual(fp_exp, fp, "The minhash fingerprint extracted from the feature is not correct.")

    def testSketchMatrix(self):
        def build_hash_functions(params_dict):
            hash_functions = []
            for params in params_dict:
                h = SketchMatrix.hash_func_generator(params['a'], params['b'], self.r, self.prime)
                hash_functions.append(h)
            return hash_functions
        hash_functions = build_hash_functions(self.hash_functions_params)
        dummy_hypergraph = Hypergraph(self.dummy_graph)
        sketch = SketchMatrix(10, 10, dummy_hypergraph, r_in=1, r_out=1, r_all=0, wl_iterations=4, hash_functions=hash_functions)
        equality = (self.sketch_exp == sketch.matrix).all()
        self.assertTrue(equality, "The computed sketch matrix is wrong.")

if __name__ == "__main__":
    #import sys;sys.argv = ['', 'Test.testFeatureExtraction']
    unittest.main()