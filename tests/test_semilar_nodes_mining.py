'''
Created on Dec 29, 2015

@author: Ivan Ivanov
'''

from ivanov.graph.algorithms.similar_nodes_mining import feature_extraction,\
    fingerprint, shingle_extraction
from ivanov.graph.algorithms.similar_nodes_mining.min_hash_function import MinHashFunction
from ivanov.graph.algorithms.similar_nodes_mining.sketch_matrix import SketchMatrix
from ivanov.graph.algorithms import similar_nodes_mining
from ivanov.graph.hypergraph import Hypergraph
from ivanov.graph import algorithms
import networkx as nx
import numpy as np
import unittest

class TestSimilarNodesMining(unittest.TestCase):
    dummy_graph = nx.MultiDiGraph()
    dummy_graph.add_node(1, labels = ["1"])
    dummy_graph.add_node(2, labels = ["2"])
    dummy_graph.add_node(3, labels = ["3"])
    dummy_graph.add_node(4, labels = ["4"])
    dummy_graph.add_node(5, labels = ["5"])
    dummy_graph.add_node(6, labels = ["6"])
    dummy_graph.add_node(7, labels = ["7"])
    dummy_graph.add_node(8, labels = ["8"])
    dummy_graph.add_node(9, labels = ["9"])
    dummy_graph.add_node(10, labels = ["10"])
    dummy_graph.add_node(11, labels = ["11"])
    dummy_graph.add_node(12, labels = ["12"])
    dummy_graph.add_node(13, labels = ["13"])
    dummy_graph.add_node(14, labels = ["14"])
    dummy_graph.add_node(15, labels = ["15"])
    dummy_graph.add_node(16, labels = ["16"])
    dummy_graph.add_edge(1, 2, label = "0")
    dummy_graph.add_edge(1, 3, label = "0")
    dummy_graph.add_edge(1, 5, label = "0")
    dummy_graph.add_edge(1, 6, label = "0")
    dummy_graph.add_edge(1, 7, label = "0")
    dummy_graph.add_edge(1, 9, label = "0")
    dummy_graph.add_edge(1, 14, label = "0")
    dummy_graph.add_edge(1, 15, label = "0")
    dummy_graph.add_edge(1, 16, label = "0")
    dummy_graph.add_edge(2, 12, label = "0")
    dummy_graph.add_edge(2, 13, label = "0")
    dummy_graph.add_edge(3, 4, label = "0")
    dummy_graph.add_edge(3, 10, label = "0")
    dummy_graph.add_edge(3, 11, label = "0")
    dummy_graph.add_edge(3, 12, label = "0")
    dummy_graph.add_edge(4, 7, label = "0")
    dummy_graph.add_edge(4, 8, label = "0")
    dummy_graph.add_edge(5, 6, label = "0")
    dummy_graph.add_edge(5, 7, label = "0")
    dummy_graph.add_edge(5, 9, label = "0")
    dummy_graph.add_edge(5, 16, label = "0")
    dummy_graph.add_edge(6, 10, label = "0")
    dummy_graph.add_edge(6, 16, label = "0")
    dummy_graph.add_edge(7, 8, label = "0")
    dummy_graph.add_edge(8, 9, label = "0")
    dummy_graph.add_edge(10, 11, label = "0")
    dummy_graph.add_edge(11, 12, label = "0")
    dummy_graph.add_edge(11, 13, label = "0")
    dummy_graph.add_edge(12, 14, label = "0")
    dummy_graph.add_edge(12, 15, label = "0")
    dummy_graph.add_edge(13, 14, label = "0")
    dummy_graph.add_edge(13, 15, label = "0")
    
    dummy_graph_features = []
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["7"])
    dummy_graph_features[-1].add_node("n_8", labels=["8"])
    dummy_graph_features[-1].add_edge("n_7", "n_8", label="0")
    
#     dummy_graph_features.append(nx.MultiDiGraph())
#     dummy_graph_features[-1].add_node("n_7", labels=["1"])
#     dummy_graph_features[-1].add_node("n_8", labels=["2"])
#     dummy_graph_features[-1].add_edge("n_7", "n_8", label="0")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["7"])
    dummy_graph_features[-1].add_node("n_4", labels=["4"])
    dummy_graph_features[-1].add_edge("n_4", "n_7", label="0")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["7"])
    dummy_graph_features[-1].add_node("n_5", labels=["5"])
    dummy_graph_features[-1].add_edge("n_5", "n_7", label="0")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["7"])
    dummy_graph_features[-1].add_node("n_1", labels=["1"])
    dummy_graph_features[-1].add_edge("n_1", "n_7", label="0")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["wl_12"])
    dummy_graph_features[-1].add_node("n_4", labels=["wl_14"])
    dummy_graph_features[-1].add_edge("n_4", "n_7", label="wl_10")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["wl_12"])
    dummy_graph_features[-1].add_node("n_5", labels=["wl_15"])
    dummy_graph_features[-1].add_edge("n_5", "n_7", label="wl_11")
    
    dummy_graph_features.append(nx.MultiDiGraph())
    dummy_graph_features[-1].add_node("n_7", labels=["wl_12"])
    dummy_graph_features[-1].add_node("n_1", labels=["wl_13"])
    dummy_graph_features[-1].add_edge("n_1", "n_7", label="wl_9")
    
    dummy_feature = nx.MultiDiGraph()
    dummy_feature.add_node("n_1", labels=["1", "2"])
    dummy_feature.add_node("n_2", labels=["3"])
    dummy_feature.add_node("n_3", labels=["4", "5", "6"])
    dummy_feature.add_edge("n_1", "n_2", label="7")
    dummy_feature.add_edge("n_3", "n_1", label="7")
    
    hash_functions_params = [{'a': 993574666356312280, 'b': 2730292699127683073}, {'a': 17902435615067968129L, 'b': 11650131884286024407L}, {'a': 9044849789609577133, 'b': 724056870380320329}, {'a': 150495597833670800, 'b': 16505954064658130649L}, {'a': 12105041367393551936L, 'b': 1150346655022162840}, {'a': 10829475974097362633L, 'b': 9153743094554957205}, {'a': 5371693517637735676, 'b': 2244018309903381299}, {'a': 12082685780530009562L, 'b': 17825075431493514879L}, {'a': 88773730355642207, 'b': 7840775997578767334}, {'a': 9761269718701208407L, 'b': 10238379417831954055L}, {'a': 11400091181049917873L, 'b': 16059578451733091018L}, {'a': 8957924485660023832, 'b': 1384449670913558080}, {'a': 1734333976174506691, 'b': 7007506693567303453}, {'a': 6282433863847579864, 'b': 3275319080396970817}, {'a': 12908265320540677863L, 'b': 13208679514669799102L}, {'a': 17888535894006444587L, 'b': 9258262771045747179L}, {'a': 7975203460043457690, 'b': 14992521968846209617L}, {'a': 8201623186251551224, 'b': 7705033276450661985}, {'a': 15466982910889551555L, 'b': 9433665244910435331L}, {'a': 3475059519763288790, 'b': 3079735646727962536}, {'a': 8343164766735088594, 'b': 13694965633093924261L}, {'a': 16361358965428914495L, 'b': 17026324821536699030L}, {'a': 11598111564251383576L, 'b': 9123682438726006510}, {'a': 18420734015078841043L, 'b': 5494895542220966398}, {'a': 9217194867963728579, 'b': 12594441620324412950L}, {'a': 16365054778108509212L, 'b': 6915713676992293446}, {'a': 8413588309448970366, 'b': 11889036274902449531L}, {'a': 17894678422045107594L, 'b': 5920182741903611877}, {'a': 7285126389515022018, 'b': 6462147507324963038}, {'a': 4909632674033365383, 'b': 14315903695300159254L}, {'a': 1655580312553434913, 'b': 16367016374714982124L}, {'a': 8885970155558257648, 'b': 14529316141033179050L}, {'a': 9081396196156929867, 'b': 8561049661810074360}, {'a': 6305330131812780041, 'b': 4871067444962254093}, {'a': 9765624861198735320L, 'b': 17518630459953957008L}, {'a': 12174054973172448609L, 'b': 11951836571754949682L}, {'a': 9073268482984339659, 'b': 1165944585789818465}, {'a': 10015945713639094466L, 'b': 12305175910755588218L}, {'a': 11481268476409573764L, 'b': 13426883452938411495L}, {'a': 5386599990668323256, 'b': 4447562115655318437}, {'a': 13263433914756649098L, 'b': 13915931408736053980L}, {'a': 8351177336050595777, 'b': 16761948258221167281L}, {'a': 8203988603704245511, 'b': 2463241976771407074}, {'a': 5788384747204865327, 'b': 12705529154337198398L}, {'a': 18043005416534712290L, 'b': 14224810046275791426L}, {'a': 15395875626914059934L, 'b': 3692046416845805583}, {'a': 4846525530662762742, 'b': 7385897155396316446}, {'a': 8414414285226700165, 'b': 4418312233725036407}, {'a': 8326759454995193158, 'b': 5889200971461061331}, {'a': 2524059605070908325, 'b': 13939202408921244379L}, {'a': 18064299897576051900L, 'b': 4924875621490466135}, {'a': 12159887543410558915L, 'b': 7685544086969630127}, {'a': 7684101984562269782, 'b': 9818378763496980943L}, {'a': 859987062004399380, 'b': 10052927211088813243L}, {'a': 9435860833109438012L, 'b': 1949549176720743801}, {'a': 7521396161869820115, 'b': 11368783416994431386L}, {'a': 14958404237072414457L, 'b': 3813505556063968470}, {'a': 11980797651495971839L, 'b': 10894056047330512618L}, {'a': 1452553076023110113, 'b': 11366434437349797654L}, {'a': 12839265262259949648L, 'b': 5168465137810587077}, {'a': 10405858179587578144L, 'b': 1333441688891995647}, {'a': 3165252584107870222, 'b': 5055908016306991638}, {'a': 13394952747819401674L, 'b': 4170230380256265505}, {'a': 5341616601880038075, 'b': 3263007946332862121}, {'a': 1598438397298686786, 'b': 18413541514477818051L}, {'a': 8395081356244066308, 'b': 11481722295162705502L}, {'a': 14229925592826936900L, 'b': 8108520785686841319}, {'a': 15810567724984262043L, 'b': 11511262545985288914L}, {'a': 11747954791791959985L, 'b': 10390671749507601695L}, {'a': 14944054498289484481L, 'b': 2079203201502209625}, {'a': 14603187945895711960L, 'b': 13473477037344584590L}, {'a': 10983156765930715910L, 'b': 14902114367271230392L}, {'a': 4978300750799802911, 'b': 12625811286768352190L}, {'a': 1029522930385249284, 'b': 17927710362856968959L}, {'a': 10231014683345064525L, 'b': 5289907767321094414}, {'a': 11575762115499270447L, 'b': 17840574677556498838L}, {'a': 14738141116137505615L, 'b': 12830118117154420355L}, {'a': 16030113542971286444L, 'b': 10788486335881793822L}, {'a': 5494406842827561060, 'b': 14363518452265258347L}, {'a': 196509551824509370, 'b': 7452769988624042850}, {'a': 11879849638262813473L, 'b': 3695362415681182605}, {'a': 8117035366176121046, 'b': 8775671263141505545}, {'a': 761143595263765093, 'b': 8444218313777431258}, {'a': 15045955817974890037L, 'b': 6772812101111744317}, {'a': 13376354981649981303L, 'b': 11166138499259003116L}, {'a': 15700055454057274791L, 'b': 13304183026216067036L}, {'a': 1757372019556435550, 'b': 16005215757529179992L}, {'a': 16559409254221073525L, 'b': 12234214542153638528L}, {'a': 11163800735912965377L, 'b': 13716343869139748129L}, {'a': 15075091666361596098L, 'b': 15051690846715740941L}, {'a': 17429903325030568216L, 'b': 6261664563134492140}, {'a': 15711385029115583257L, 'b': 15087220248092508288L}, {'a': 10514180653248945129L, 'b': 5434379203309165764}, {'a': 8127186406403374399, 'b': 6566378918441458969}, {'a': 17989453962047725810L, 'b': 1634853986541149235}, {'a': 1043004623874515197, 'b': 297546035811033557}, {'a': 16344153534297102893L, 'b': 2189774368552675128}, {'a': 6895771409777582992, 'b': 2871642730309916034}, {'a': 9171156337947874491, 'b': 3155619798885141495}, {'a': 15448379696960526042L, 'b': 16071008118693014570L}]
    sketch_exp = np.array([
        [311619508415327868, 1015918523769474007, 906409040846910258, 311619508415327868, 311619508415327868, 311619508415327868, 264688396888428259, 3317768184857971426, 1566520545876572570, 57882299294506319, 2767244694385779622, 1903139734046231204, 81076610722328469, 176096217094727904, 929127885774585079, 851848510670258423],
        [696706284430762576, 6024958198896344307, 569016250230909053, 696706284430762576, 696706284430762576, 696706284430762576, 96694904054827793, 1370876413309111, 1085287358479591624, 331958844328955594, 1696526183940357079, 124326838808723871, 1085287358479591624, 1085287358479591624, 696706284430762576, 4393930487532502117],
        [1684443320397645357, 2726985233745431094, 1684443320397645357, 6048304349769563962, 1590812842353717020, 1684443320397645357, 415277826800973047, 4862307079973851562, 618437293580480490, 844028315673753109, 475626464057422392, 475626464057422392, 415277826800973047, 213838962074259349, 4232613353776164908, 475626464057422392],
        [212170247389494051, 2157660030032491540, 445757356340861920, 742443275392324262, 43158659690920938, 2670806724234854586, 1537150512935159888, 1819530166691325734, 1864467603131532102, 2114995424101784425, 1819530166691325734, 1819530166691325734, 1446511984546351477, 2746935657029675980, 415429967323589417, 301774604944100229],
        [583353731501194025, 664877789777514765, 1535308313036035389, 2834622956679059837, 2122392023647281287, 1441554946391876987, 46554874151202697, 1184799715421246943, 31538050709216975, 1701464238626929316, 1100473430212796700, 839981267383149372, 1575163339094906125, 1535308313036035389, 1927661589154436494, 1184799715421246943],
        [317574489444903794, 10886731100701861, 349565852465500725, 317574489444903794, 317574489444903794, 317574489444903794, 1886353272590349263, 4961875570651648724, 492595366739445722, 2396940985957087939, 2287813423290762741, 2287813423290762741, 492595366739445722, 177239657637368365, 317574489444903794, 6998339889988091461],
        [7210144214586306059, 3046860998957997263, 3034382001554217096, 2142702235138373916, 65559308238537975, 3831963709006899541, 510213785603848986, 3596401085105430353, 233143956741432822, 4010031281656347311, 243795795965370894, 243795795965370894, 5440947796888811752, 638510672518404475, 3976413250887848437, 1505059101480977427],
        [201269787635489647, 837413931135827261, 623417344699139486, 627930449659611027, 2165061810639981454, 2224201233391976751, 63585274761944188, 846373946172610609, 1791496014516899429, 138684857410576453, 846373946172610609, 846373946172610609, 419798530375437900, 2121932310027995558, 2995502696077533183, 846373946172610609],
        [4281436433796536068, 416254669362685455, 2023136413710286305, 4098483233349166481, 7398077536409079661, 932366214949815639, 1268422891037942357, 89379341972077927, 1371087880816458964, 4244528717783697752, 335453841945053615, 335453841945053615, 391109772209361543, 1371087880816458964, 1371087880816458964, 89379341972077927],
        [5353570106572639181, 197998571654503394, 1955948541326130842, 3167379753100335341, 2252274134234670312, 2284856607025450296, 309735340195198027, 482923407562725954, 197998571654503394, 1284329446085653286, 1295003186953059320, 1295003186953059320, 2646268409696881423, 917320640442219225, 783675214978765662, 482923407562725954],
        [1857335640526670627, 1285673565180632237, 883436039847753092, 1285673565180632237, 2145430190553350964, 227502459529101448, 778126319309869240, 570272945798103186, 883436039847753092, 2145430190553350964, 995926803612381701, 995926803612381701, 272136604923708218, 883436039847753092, 1394276928386516545, 883436039847753092],
        [208178393206228963, 409722970089882247, 3723317155147785502, 409722970089882247, 212319384662183530, 409722970089882247, 409722970089882247, 2134551056573989591, 848088765405955456, 6683070311846569753, 264817671267157471, 264817671267157471, 840659679428039818, 741278443329035301, 2763558378830116649, 2134551056573989591],
        [1244789820810360575, 6075957833377911522, 1244789820810360575, 1060417186698011638, 1397451349678427357, 1244789820810360575, 1244789820810360575, 340651753773750449, 899972693030423243, 2307160395826655897, 340651753773750449, 340651753773750449, 899972693030423243, 899972693030423243, 899972693030423243, 340651753773750449],
        [952035934063073217, 671349523959127026, 312473018821727515, 740053150328126175, 3109559419664753758, 952035934063073217, 73133698926805162, 312473018821727515, 312473018821727515, 3669112777858681664, 762851480677783702, 762851480677783702, 1332087617000413063, 312473018821727515, 4835024183980150017, 312473018821727515],
        [2426343687150415673, 2758625947194151932, 481609353250649839, 2758625947194151932, 531208153740610635, 2903952155287516877, 418611028966176916, 786625867448747385, 1173196440861292628, 5094584456428093193, 645156899747422757, 645156899747422757, 346127123416954677, 1067539780894332321, 979915168183210930, 490655760052872630],
        [1149450424455388582, 2624764574541755413, 2116677292801153654, 2120753717721149105, 1731305514543536258, 2116677292801153654, 514688129663853546, 2023678120410635052, 663814398931774353, 2297249857653839101, 575180745138955909, 575180745138955909, 3011153445824108229, 1521328220685810228, 235784025276639439, 1580746028004364684],
        [15352359821989572, 10652535957239578, 7183804069850832057, 958546654078699197, 2800778771460679972, 81951639596620580, 569030327124415517, 680825091559389905, 359697962031051236, 3049790521446752081, 508413982799003225, 508413982799003225, 359697962031051236, 359697962031051236, 359697962031051236, 210520015655970825],
        [4160365019009577107, 1811590453935595531, 744312262121544413, 1487828559344893029, 3148333056988768773, 1965519917437095099, 461095815094260714, 2021519009899883648, 4160365019009577107, 3148333056988768773, 2021519009899883648, 2021519009899883648, 1935917015732050457, 2510583294389828735, 314727043589828263, 1395181280839762551],
        [2849677644545981891, 739071697333727402, 6961905070487044972, 1247728467792375628, 878166516084813641, 1247728467792375628, 246005490457130305, 1349825214164943881, 4229480140753852318, 7719814130035304285, 1349825214164943881, 1349825214164943881, 246005490457130305, 684089265883355184, 945664521697132697, 3297101193208769065],
        [2044463499937065632, 4458080283663683216, 2237553231286632808, 2217697094665472278, 941679508418984209, 134637297468113023, 1172421719221916388, 809658849318245387, 2237553231286632808, 7734247621500524660, 3036214534400515178, 3036214534400515178, 853874076806118947, 2445171904280134519, 1889280025087489515, 809658849318245387],
        [3035258802032251675, 968214865716817963, 958795627473130030, 1047158160112060124, 8654531962775352532, 516934884222755735, 256228223955355340, 989391333394509902, 276450168284587948, 208494909638193661, 1173542903633277641, 1173542903633277641, 276450168284587948, 276450168284587948, 276450168284587948, 1173542903633277641],
        [1426663096246337951, 721064494537329521, 2432575075372743402, 296890695033050946, 296890695033050946, 1426663096246337951, 1139467632677252555, 4246090008240624839, 2168283998407245288, 296890695033050946, 952713593487615171, 952713593487615171, 2517898695803115537, 2199576458002329239, 2199576458002329239, 952713593487615171],
        [1604954800749852551, 3380133125184116813, 855814198978470929, 1604954800749852551, 1604954800749852551, 96221547602331819, 22730958574087215, 1372658440491752613, 2715719984648029578, 4138384113947021037, 591905495423456823, 318725282823435877, 22730958574087215, 995072810130351200, 1356693304772998611, 1304318653494932308],
        [5681199765474485477, 6128774157378961688, 220659392493677875, 940779398438763303, 535664875198126850, 438329883559935434, 109501281060307556, 439796139514607784, 2170978564855820789, 1261014572250407599, 439796139514607784, 439796139514607784, 535664875198126850, 535664875198126850, 535664875198126850, 940779398438763303],
        [1162722459454335921, 3727874126991284495, 1851751258113882564, 2363176416008112373, 2363176416008112373, 1649593897505463852, 128364293330162977, 12151360409572168, 334571305581559467, 5941235604396720974, 12151360409572168, 12151360409572168, 1175124140243708001, 128364293330162977, 395736378695518987, 12151360409572168],
        [1814117883237992900, 84064071039598470, 2996016247191262804, 192671685862481674, 1471081123122515973, 1155698477630555245, 632556708273374162, 1264219681839404904, 324993542248461165, 10045152082912160250, 1026989911601935164, 1026989911601935164, 324993542248461165, 350318661560519983, 953603772143467833, 1283366751517185773],
        [1141264450707342167, 721736450759390598, 979494631984998193, 721736450759390598, 6749988480278416782, 553388272818466690, 924091091015107994, 2216940166816399313, 1402854776745947867, 819137047677301574, 325313145887564715, 3830413918715232319, 736607669480680492, 353055414679829879, 1402854776745947867, 324572368744194099],
        [456395046105626130, 1337194791067489642, 1506418221625345413, 404808378985254966, 1758775274522626969, 2146245643488136738, 97201393103826939, 3150480896177497561, 768949032860383438, 1643773926061490223, 324842607114605664, 324842607114605664, 973598856352182859, 2187418858137522891, 2187418858137522891, 1551323432758890634],
        [6782292896836891396, 202660434992600521, 6782292896836891396, 1111889396419971391, 2955973762035702508, 598516294878301012, 818119109457148595, 2671882995193314984, 138640081221994996, 2955973762035702508, 3998915366004650412, 4135178012551980441, 564554112141366540, 2276847408049545332, 138640081221994996, 2671882995193314984],
        [1071224091975782056, 2478265843794677916, 243458869694421856, 148196112993283484, 148196112993283484, 1690106122248983915, 47578807677845363, 575120353538816651, 333707305657921587, 355382915142507605, 566077808750465718, 566077808750465718, 1979921378999492149, 47578807677845363, 333707305657921587, 148196112993283484],
        [774442989398547448, 774442989398547448, 774442989398547448, 971107899705760728, 745478090919487232, 774442989398547448, 742019626833034389, 1906091453405619274, 3418030541161079294, 742019626833034389, 564009549805409098, 1168393669787440790, 646811170817091183, 381389536432179201, 908690790618067678, 903385544200860503],
        [2697166630151240435, 1015871616177906099, 1067277088202624146, 1015871616177906099, 5338998700024006179, 3017520330632186486, 315387364355532191, 2073697804557953209, 3017520330632186486, 1753441078733248622, 1014791576248250094, 1014791576248250094, 995617457219975230, 133556564908932664, 2530116723334360443, 1488801429486063485],
        [615384053956866890, 615384053956866890, 615384053956866890, 1617481680740859913, 2531953826361331187, 615384053956866890, 960926846855777982, 852815850640180584, 778120089244939534, 2501157233926176359, 852815850640180584, 852815850640180584, 2617365147009536891, 1833768816254689639, 538352732498708214, 2881075999682638789],
        [3139478138070961115, 559708506205192634, 3139478138070961115, 1304741756765993909, 276920436056569850, 3139478138070961115, 925858860972328167, 3410462917280853033, 39537753623996806, 1107057942069662339, 3410462917280853033, 294003556316234811, 597478494534601204, 597478494534601204, 597478494534601204, 3410462917280853033],
        [1746031477410254348, 2636438743552858443, 133920838158869629, 1975820584611482043, 2389417778697916844, 2636438743552858443, 392945524716799419, 1165566101040262652, 739818414826546783, 3290727645207044017, 1281302454218609961, 1295539996974813062, 6793806458852117866, 1658435355538907616, 20817740611273003, 1165566101040262652],
        [3626772506381365975, 5790343705338316078, 1385168367968683009, 243596109189086001, 913792664943361688, 1958969638033956520, 1395038026455585648, 131962614717209697, 1385168367968683009, 2413465563322640007, 131962614717209697, 131962614717209697, 4366992897036395456, 1385168367968683009, 4366992897036395456, 45972553744998876],
        [288457002606334021, 738211946144374260, 1348178390948632739, 738211946144374260, 331500418963873765, 797132467039982013, 797132467039982013, 1459705241175698494, 649914852795256904, 3157295558057734784, 1699640326733736999, 6309317185934835154, 3013847107220365596, 2233491485930258472, 2881961648858651857, 1198771472491027015],
        [287390376912327141, 1063564643913163558, 287390376912327141, 940976211757218478, 940976211757218478, 495342783478126627, 1063564643913163558, 818387779601273398, 223535461236345865, 762277841135544737, 1516946428740999918, 1516946428740999918, 2910186985412283137, 818387779601273398, 223535461236345865, 818387779601273398],
        [915624979476077435, 3871115682769313392, 2154847989129155042, 2644279504648087, 2644279504648087, 1762873943124854159, 1885303605708264919, 2154847989129155042, 205771050664227599, 4212227331370582443, 2966410669232868131, 2966410669232868131, 5027800374651082645, 857573344256571913, 5076648547775899128, 2644279504648087],
        [978710486435637044, 4590781640704135842, 1158544405226033545, 3639829492186488437, 4354481696852278276, 386604278074967187, 990512367349003365, 2308070848524201095, 1499729832015938395, 2321260890193368539, 1050080636086473680, 1050080636086473680, 1751334876191957935, 990512367349003365, 367352147806262829, 1050080636086473680],
        [3592296482760261487, 35178469785552403, 6512737538677631387, 543992173397520158, 1845834399591463607, 366678377813059632, 170163845911505834, 2353003437313657217, 35178469785552403, 1630332654246421333, 391419981344415157, 391419981344415157, 903578441782104124, 2621298310868517744, 4066040599432518575, 1845834399591463607],
        [876308790262095266, 2794103160194313471, 200866415683559578, 898835810145563787, 898835810145563787, 898835810145563787, 829217111595722804, 1791519632910798971, 728387168655242656, 4822839364407193436, 1599783865511934670, 1212183984971304449, 728387168655242656, 2648791350139526402, 898835810145563787, 1376532697197370266],
        [1634519559168393982, 341204884446151408, 2789590769555805126, 341204884446151408, 891260992963009, 2011654400796457986, 322991780632091629, 6691528304171195176, 4199029114818485179, 927142057373353164, 1675762230060171816, 1675762230060171816, 891260992963009, 891260992963009, 891260992963009, 1609511461516875251],
        [356299478541028476, 2053563547543831543, 2401742125519455403, 1323587420677030067, 1323587420677030067, 1419780224854953759, 590174578709379905, 1903994935583540686, 2053563547543831543, 174547137559257536, 1481193949705383323, 1481193949705383323, 2065229072550267974, 646386581509666201, 2359632513488220939, 1323587420677030067],
        [82236120828957248, 354198026710876702, 1684677890400001590, 82236120828957248, 82236120828957248, 82236120828957248, 137160047059700612, 385736029490275030, 1894419772485037814, 6066455026599158500, 3882915847420716683, 144203061080738067, 125284986639128011, 1230464647795736488, 1876195868224062602, 630550829491261876],
        [1541558998222094160, 1541558998222094160, 508806166169124942, 1153026460987110103, 2831995802823843696, 1541558998222094160, 398810915943049687, 3206813209550222191, 486529282202158979, 2787652324089113346, 3077354487994235794, 6217044663894957296, 298133065809751319, 1228768796816461987, 486529282202158979, 23567748608778942],
        [1123629383066727150, 63022140639913412, 2459604524666046364, 1123629383066727150, 1123629383066727150, 1123629383066727150, 184557749075255954, 2459604524666046364, 1675419415819036152, 3301321353663461688, 4585696501703431009, 1106172149812094274, 1290116272712681269, 1668245057323940129, 1870961021740706994, 2459604524666046364],
        [563236945039312761, 2784615325763229543, 1569037679281552584, 1208051509674279078, 85283554730136853, 2734454700409651868, 1163826242362843599, 629712906384382461, 1320616303484570845, 1208051509674279078, 1834326978737633777, 2105488943101851827, 742307495585057134, 742307495585057134, 742307495585057134, 629712906384382461],
        [1492092285596709057, 1629689570536090030, 1492092285596709057, 1979579252590476329, 143157055365342985, 1492092285596709057, 1492092285596709057, 1877310683013459750, 1142744584383285309, 337319788145524367, 1877310683013459750, 1853460462712700039, 143157055365342985, 143157055365342985, 143157055365342985, 3278862108169801062],
        [2365305488536715269, 662566481026824114, 752989557531291062, 2365305488536715269, 2365305488536715269, 84761790982916155, 2349751325501176568, 2479584018695958867, 84761790982916155, 2647258851947748767, 3463110439057733120, 3463110439057733120, 3771166604940459883, 1663436066453164854, 1291474070687486537, 1496430772074326014],
        [213955345421875057, 3242380194213064206, 2259740432428852355, 1030807040778019832, 393468116203095148, 261759889144009846, 96232671719884984, 797686537854183113, 827293124578926316, 96232671719884984, 1979343755474251199, 1979343755474251199, 2328442598383073700, 1350330556325285911, 2781863495406089185, 797686537854183113],
        [554512053426928587, 554512053426928587, 36184606198207847, 1088238978869072861, 1349234535034999286, 554512053426928587, 2929407543452866541, 893061826887774847, 986340862836986863, 2929407543452866541, 717612059730053839, 717612059730053839, 2482016282304466381, 2482016282304466381, 314573392634952501, 893061826887774847],
        [6988007901192740495, 6783854358778770169, 7041597211573869126, 397790643191245813, 2185368242519276958, 2134830833405027536, 1132310001306628827, 4205923866102489417, 1054795702587498834, 4306078832140944343, 497985812637205461, 497985812637205461, 1591378075243472580, 1591378075243472580, 1591378075243472580, 2169323690936822703],
        [2247038524267436950, 4571937954446422, 5035417121316208017, 845038464595489544, 1643717100514612253, 4089710611036731046, 4571937954446422, 1014107061895884345, 908870403697407356, 3485755776981588261, 1014107061895884345, 1014107061895884345, 908870403697407356, 222303343533778529, 3436123040335458187, 1014107061895884345],
        [1518916632887295055, 2151505091376216355, 4364132203734007897, 1035188745405129794, 2880224271385008197, 244809960202523170, 698466846466492630, 7152955153437184798, 3522306797954838250, 1286179243287843832, 2204836595096389254, 1259083828342879505, 2002658828796586522, 439017809468028369, 2893646772945919366, 7152955153437184798],
        [2037536388194066042, 4505007490872248439, 194270669878458408, 3891998676048350862, 451055368828261000, 4505007490872248439, 40281380371370443, 68763917447840962, 2979644596033272129, 1993175078824310648, 68763917447840962, 68763917447840962, 451055368828261000, 451055368828261000, 451055368828261000, 1428636242711223215],
        [1428280612268493295, 3370504977082138779, 7260891760149973554, 1428280612268493295, 811741534906977971, 185090154672687417, 215920523855225468, 5629172146111611857, 1282990836004757749, 483902698726795871, 1038271851963407766, 3032084089987709323, 214594146047065190, 1548310531542222827, 1428280612268493295, 1267558557715376453],
        [2332339649378853146, 3675733326357269646, 4151994262697831328, 2332339649378853146, 663579959975730436, 2332339649378853146, 2060759659254347303, 76002857924262897, 1140903968386210185, 2299270846117996300, 407367759449107223, 407367759449107223, 1324845575174330626, 1732925636967962750, 5357826317808360548, 76002857924262897],
        [1445798550153232488, 1250858205485295974, 1445798550153232488, 3060146720465428077, 3060146720465428077, 630013946747561612, 1624571246707129973, 6073172980180123329, 2828946445081546459, 795637010837221146, 2439420476583339769, 2439420476583339769, 8337591756927073209, 1624571246707129973, 202501993766623652, 3390551499294394754],
        [3342939063446731040, 1316552024177857198, 1466362126734804972, 3273327445895394750, 442476838162526949, 4347630916358280399, 320639640493945474, 284294496892150398, 342337101659059853, 2361356858327590062, 284294496892150398, 284294496892150398, 5175760875766134952, 1385686325136778126, 342337101659059853, 284294496892150398],
        [1384911371029300291, 443857210203170287, 1384911371029300291, 222244474245612991, 2162177136444415059, 1384911371029300291, 191962790817504370, 883130262942120364, 1384911371029300291, 1068959472238786138, 154247420676561606, 383973333976666485, 235165178827862113, 191962790817504370, 4053559750046935950, 883130262942120364],
        [3260351963093682655, 917415895060760819, 342508660379856123, 2410574036215791109, 12408910634706010, 497623263288934744, 1987867079533340337, 342508660379856123, 342508660379856123, 1948927663535336865, 1588988725323879678, 1574799243240455147, 12408910634706010, 12408910634706010, 12408910634706010, 342508660379856123],
        [1072904137460724687, 829875591695799854, 1072904137460724687, 2461926866276524275, 3384665519727155883, 1072904137460724687, 829875591695799854, 202199760833918176, 335432426010060548, 6013270242467460135, 202199760833918176, 202199760833918176, 816333109004957310, 1797596146877172921, 4927911220257866402, 2329357960940242821],
        [1917237984730661597, 4473224356448645210, 5896354237556368416, 4608225703445045819, 2785239177706303705, 1091344857537720944, 124044627883306946, 553362674971205019, 952929223152554715, 3033977974943492218, 740153604740194725, 54175189780495616, 1623287673510629796, 2008966986023272561, 606970668921048732, 553362674971205019],
        [2008256840840269182, 3757856790814349, 7355751938040161514, 2008256840840269182, 2008256840840269182, 2008256840840269182, 553051634211798779, 2671927407781990419, 1968524379904960987, 3912010091844333785, 508312766614829419, 508312766614829419, 5175868922652090695, 570397802200101603, 7264226904334028417, 1328741894612171685],
        [6707633193039485, 237506323627833186, 235647166435413608, 6707633193039485, 6707633193039485, 6707633193039485, 2658834025032139362, 767848523738720041, 649234105185627850, 4674172858018941375, 524385449316378632, 524385449316378632, 7345446266348249850, 767848523738720041, 5768073984984060431, 767848523738720041],
        [199913066815718115, 199913066815718115, 199913066815718115, 1947084359309903985, 419581620607390705, 199913066815718115, 686151836065752914, 2882604993744212666, 1338850512272568947, 6594406709706384707, 761624929721893412, 761624929721893412, 1338850512272568947, 651939778921299879, 1338850512272568947, 761624929721893412],
        [1786410383898054310, 1514271106988109439, 1668176812551290350, 1400339271147052325, 870829352771433887, 1786410383898054310, 40697365044177558, 2933658711264547170, 76282841236635647, 2929401149330568711, 656199853131466491, 755232309714649502, 1127316812255585111, 3909954753346744328, 2454779226629514816, 2933658711264547170],
        [1954920798498541061, 1966495873046258214, 1301286047674481614, 169177779511899807, 411408365974142899, 1769549936410184190, 67047250717707730, 3088484965895290856, 526791762275944830, 1922653969675838734, 2026130451498256440, 73333445293827779, 1992661729593366816, 1209653016173266153, 1209653016173266153, 1445122437307693253],
        [6348392524625722504, 2355148665954874, 1510595783456857301, 2763993229048052228, 905737042993182547, 2546114558812190013, 16423083987530230, 5275759438768651300, 62402589224705314, 1663731139306376349, 1098876958939376952, 1098876958939376952, 1191708406493716886, 2280409654273285578, 209437260292029758, 27474702099638838],
        [4976508505111321175, 665166640444139568, 1102902941710529962, 1971555921040911729, 170824773320326426, 1329979386779782171, 139946933217670167, 1102902941710529962, 390896972034762614, 6402475926455559197, 4589452857653063711, 6663290685017193820, 753951523877157327, 753951523877157327, 753951523877157327, 431360667214572671],
        [1549408290719497190, 2049491908415554240, 1463213343044406743, 2019420888570608458, 2906705586577906585, 1929286821252247345, 816905124336092967, 896652011787810192, 1113832550260105985, 2906705586577906585, 457778366983864697, 457778366983864697, 5656350151067766340, 93597533686704511, 1036763858259633459, 15546965615727687],
        [1935804495399787667, 1588839061140551810, 1935804495399787667, 2510896359820122339, 2726847804215920816, 2238734576672138840, 1660001239539178387, 589944009488069653, 1817040552303357862, 2799875281350297921, 22394033427702208, 22394033427702208, 1548031175216833269, 67880812690022762, 1817040552303357862, 589944009488069653],
        [841472385408391788, 1277396167729165196, 5931771872679762862, 2322521327271880024, 498867242649022064, 5524632530770765070, 2047700140437100705, 717984732082062119, 2526880138308387079, 4108188552649660423, 717984732082062119, 717984732082062119, 298411293087618798, 9234551623430779, 3095255300302960408, 1951204680538365544],
        [4058852230718176551, 7175277403603341340, 4561133546500080563, 4482736100248155507, 4482736100248155507, 2271315237572547436, 858338695315510930, 1954813774574002987, 1263613474761279101, 858338695315510930, 1954813774574002987, 1954813774574002987, 1537761033761119026, 4468125372564165174, 4468125372564165174, 1954813774574002987],
        [227481120617721871, 195617347188522540, 3322158946349754062, 227481120617721871, 227481120617721871, 227481120617721871, 1668212608951943474, 669179557122065307, 195617347188522540, 246594278776652851, 2543919205261515568, 2543919205261515568, 1568021752929149226, 1568021752929149226, 386224056109093363, 628401242304580860],
        [840448399331203011, 2665224320338634852, 229819716671040948, 2665224320338634852, 1592371500665395941, 2313863678137343280, 89026201529154383, 2210530117955710399, 396437472327627748, 5061286276888043568, 1409954862172125993, 1409954862172125993, 845338982118867395, 765063029988972340, 1119198223593121074, 95664093472386578],
        [722495812077749788, 722495812077749788, 722495812077749788, 933457447891372308, 3308807645526200946, 722495812077749788, 729039505567213167, 1301476479494791490, 768670974283666595, 7964370863031848501, 753472556890154807, 753472556890154807, 768670974283666595, 729039505567213167, 768670974283666595, 753472556890154807],
        [1075834856901680259, 3877601358067960612, 88947680073364892, 10450386616873710, 10450386616873710, 290529705415783946, 1075834856901680259, 2660169832415129041, 290529705415783946, 10450386616873710, 1592487217756681057, 1592487217756681057, 663749580226054569, 663749580226054569, 113137601558595510, 2660169832415129041],
        [2093610515778938197, 596451818789731937, 5456318723775617236, 2093610515778938197, 1190160554694548388, 67813063972810276, 2055607454946765207, 492623646850434496, 4093361768169745528, 3021042326388964704, 492623646850434496, 492623646850434496, 1190160554694548388, 407094037071398735, 1190160554694548388, 492623646850434496],
        [3534434514374514323, 2279777776455608450, 2211060453717908376, 199810868172951000, 3534434514374514323, 782750267959920002, 562885735342437771, 728872517564321187, 409553842796807686, 445088493161979095, 5001588763094781823, 5001588763094781823, 276282759479921465, 409553842796807686, 409553842796807686, 641113955790522385],
        [300958290155076369, 3475295854626606213, 1440237317333563829, 300958290155076369, 300958290155076369, 300958290155076369, 2531977437259307491, 790430502617122218, 1303502637862501662, 3498966411606050463, 1374700775127056689, 1374700775127056689, 2504238486694242703, 1715271261026885238, 1622789163822850110, 790430502617122218],
        [2329030089064660289, 2068580480425255080, 2329030089064660289, 1644817492550072348, 2147432871616673297, 2192538964795637618, 54369530445677475, 535885415284152063, 940914847512668838, 515731193365140838, 7000037998736308177, 3146476179407169869, 3271604474603293401, 675960074070487356, 3271604474603293401, 352317584369719108],
        [2802562027260344189, 4279963432679724375, 2833282336119912023, 243718899271972271, 257896918845523390, 47019198657338945, 857425269036130295, 617469762416110588, 2593153777986822056, 9179288496324526046, 617469762416110588, 617469762416110588, 1927763328116221456, 367065655410834253, 367065655410834253, 392261785700335744],
        [2483949970460302922, 93944902806927484, 2497812316334484354, 93944902806927484, 350867217781166783, 93944902806927484, 93944902806927484, 991591919115325925, 2003871001561259310, 1713306950475424789, 670590989152821096, 670590989152821096, 4179545579680344246, 415671802094178402, 7763513836978235615, 1065729813171519918],
        [1205296869486678382, 2196326932042118330, 2436178550949940168, 3102325497065345845, 1486559019644206523, 1346589313436580919, 825106270975383301, 1949023822167500037, 852573984552864466, 29198713794839225, 1332765886595875, 1332765886595875, 1537475826692448328, 915119438941535633, 1537475826692448328, 4648119408866288227],
        [4978734126110845446, 6426459367989148500, 5540840157094193960, 1047056559111244078, 2637323531786318249, 1000654551698925254, 375436413059664868, 2713225960953856462, 305010095780732761, 611518125422762206, 2265084277442034775, 2265084277442034775, 3917142166963937769, 53030003407769655, 2938296677962094446, 219568465077442644],
        [1382315342399116312, 744302880803525406, 1382315342399116312, 4318684695443256549, 3015585778176722454, 978206350002057895, 517909020450507764, 706489180679210669, 218155379403368377, 1507727788717635278, 2626621513998641783, 2626621513998641783, 218155379403368377, 2354681731291742703, 1430136507462056087, 3157137413530908504],
        [2585472624000535146, 3350101585423442774, 2585472624000535146, 826426132730439699, 2003202788718343593, 1455199693593338335, 293861417655649212, 1201923393542138693, 1455199693593338335, 240470375304280515, 193699189982268985, 193699189982268985, 616925066857502892, 119370863956744172, 119370863956744172, 1201923393542138693],
        [873271092502877422, 1154202688734586339, 873271092502877422, 5107700669927727279, 1882405393384042785, 873271092502877422, 110960975806188615, 2415542897282189720, 873271092502877422, 730559253955981928, 1977518008177582876, 1977518008177582876, 654090067031633152, 2051848037841678469, 1354427182165659994, 2415542897282189720],
        [2501909597385601149, 2212868658271590124, 1033429099289482331, 9891192537556907, 2665808794235077506, 206723132887551845, 1012764632606049783, 763851313516371957, 1033429099289482331, 824386737206838975, 763851313516371957, 416328313644284250, 589605532475172697, 1033429099289482331, 2665808794235077506, 514298219719383571],
        [819466134397969418, 1080085990753832558, 1409202118823542383, 819466134397969418, 819466134397969418, 819466134397969418, 851724403513803196, 886616204553872340, 896424004661955827, 851724403513803196, 1875111818540267474, 230340198437316260, 1408407892304665553, 1167456788196317782, 819466134397969418, 786024238983246416],
        [2615330579427172838, 308296536465108719, 419258468109392310, 1769124087794211061, 643141382007674887, 2615330579427172838, 568616383645939580, 4982094461103065788, 608608611254332286, 751301248661235144, 591358948200867736, 591358948200867736, 4708265680633113034, 9710288463689812, 9710288463689812, 4982094461103065788],
        [71955389698903501, 1223858736446726540, 3174388950016292173, 1873227347024370252, 1110033898795055467, 3207280184841811337, 3301887673408882394, 1326802831497541193, 1223858736446726540, 1155094760354602016, 594165235901553854, 594165235901553854, 684703751845597969, 3068475425411551111, 188171298730775724, 594165235901553854],
        [6183333118033163399, 702750448504599968, 2680291182707679920, 702750448504599968, 3964628540403485605, 367744634153792661, 1730109824113583268, 335906189888020364, 1444997708874203420, 3964628540403485605, 335906189888020364, 335906189888020364, 319672934630336986, 1138855197242966277, 1444997708874203420, 2853432073249798405],
        [338314271292625882, 308653272112228219, 338314271292625882, 15989147764385695, 397748931459198194, 338314271292625882, 44109470553868457, 2762191420429079287, 2324993486343487125, 866636911856525585, 2895571279834966945, 2895571279834966945, 4086750676024176729, 193283929062901323, 2362084549344135526, 24850294560713027],
        [5909165189971931975, 1495974822282392119, 1247285017030783524, 1495974822282392119, 1191026223849543243, 6298940909811320211, 464491053260093101, 1468019938048553518, 209219463332999343, 2900650854113422403, 1468019938048553518, 110356197081361332, 556450101911461643, 206635233988218612, 209219463332999343, 1468019938048553518],
        [106886204744410686, 418978270306864848, 878807226083760921, 418978270306864848, 4144677756747521361, 418978270306864848, 418978270306864848, 3757994940471519992, 647744327478485535, 1566952590706637448, 779554860460418997, 779554860460418997, 851107651318998277, 1677808649383980554, 5220078737394707362, 5473343621881974063],
        [38593366140317197, 1902486392982458286, 2178464647919202026, 38593366140317197, 38593366140317197, 38593366140317197, 1285115176956205426, 219751857956640315, 1095801137768950499, 2039647751544812007, 219751857956640315, 219751857956640315, 2733621076232465056, 1285115176956205426, 38593366140317197, 2511499696131020752],
        [6625913403702545333, 2948784102647976144, 1570346735341492421, 459327482555104153, 459327482555104153, 2402724076959988150, 1312748275525442550, 830824673340114043, 525093800112728157, 3952334632645649622, 830824673340114043, 830824673340114043, 2152544196647872536, 1390367671116285501, 1541221045321469044, 459327482555104153]
    ], dtype=np.uint64)
    
    def testFeatureExtraction(self):
        labels_lists_exp = [
            '0', '7', '8',
            'wl_0;wl_1,wl_2', 'wl_1;wl_0', 'wl_2;wl_0',
            '1', '4', '5',
            'wl_0;wl_1,wl_6', 'wl_0;wl_1,wl_7', 'wl_0;wl_1,wl_8', 'wl_1;wl_0,wl_0,wl_0', 'wl_6;wl_0', 'wl_7;wl_0', 'wl_8;wl_0',
            'wl_10;wl_12,wl_14', 'wl_11;wl_12,wl_15', 'wl_12;wl_10,wl_11,wl_9', 'wl_13;wl_9', 'wl_14;wl_10', 'wl_15;wl_11', 'wl_9;wl_12,wl_13'
        ]
        dummy_hypergraph = Hypergraph(self.dummy_graph)
        features, labels_lists = feature_extraction.extract_features("n_7", dummy_hypergraph, r_in=1, r_out=1, r_all=0, wl_iterations=4)
        self.assertEqual(labels_lists_exp, labels_lists, "The wrong labels lists were computed by Weisfeiler-Lehman.")
        isomorphic = all([algorithms.isomorphic(features[i], self.dummy_graph_features[i]) for i in range(len(features))])
        self.assertTrue(isomorphic, "Wrong features extracted.")
    
    def testRabinFingerprint(self):
        dummy_binary_array = np.array([1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0])
        fp = fingerprint.rabin_fingerprint(dummy_binary_array)
        self.assertEqual(np.uint64(9332362780641026048), fp, "The calculated fingerprint is wrong.")
    
    def testShingleExtraction(self):
        shingles_exp = [
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),4),1)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),5),1)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),6),1)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),4),2)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),5),2)",
            "(0.1;(1.2;(7,((0,1))),3),(1.2;(7,((1,0))),6),2)"
        ]
        shingles = shingle_extraction.extract_shingles(self.dummy_feature)
        self.assertEqual(shingles_exp, list(shingles), "Wrong shingles were extracted from feature.")
    
    def testGetMinhashFingerprintNaive(self):
        a = int(6638699916324237062) # random number
        b = int(13296106891814937365) # random number
        h = MinHashFunction(a, b)
        
        fp_exp = np.uint64(13099543911338852352)
        fp = fingerprint.get_minhash_fingerprint_naive(self.dummy_feature, h)
        self.assertEqual(fp_exp, fp, "The minhash fingerprint extracted from the feature is not correct.")

    def testSketchMatrix(self):
        def build_hash_functions(params_dict):
            hash_functions = []
            for params in params_dict:
                h = MinHashFunction(params['a'], params['b'])
                hash_functions.append(h)
            return hash_functions
        hash_functions = build_hash_functions(self.hash_functions_params)
        dummy_hypergraph = Hypergraph(self.dummy_graph)
        sketch = SketchMatrix(5, 20, dummy_hypergraph, r_in=2, r_out=2, r_all=0, wl_iterations=4, hash_functions=hash_functions)
        equality = (self.sketch_exp == sketch.matrix).all()
        self.assertTrue(equality, "The computed sketch matrix is wrong.")
    
    def testSimilarityMatrix(self):
        cols = {u'n_8': 0, u'n_9': 1, u'n_4': 2, u'n_5': 3, u'n_6': 4, u'n_7': 5, u'n_1': 6, u'n_2': 7, u'n_3': 8, u'n_16': 9, u'n_14': 10, u'n_15': 11, u'n_12': 12, u'n_13': 13, u'n_10': 14, u'n_11': 15}
        similarity_matrix_exp = np.zeros((16, 16))
        similarity_matrix_exp[10, 11] = 1.
        sketch_matrix = SketchMatrix(5, 20, matrix=self.sketch_exp, cols=cols)
        similarity_matrix, _ = similar_nodes_mining.get_node_similarity_matrix(sketch_matrix)
        equality = (similarity_matrix_exp == similarity_matrix).all()
        self.assertTrue(equality, "The computed similarity matrix is not correct")
    
    def testGetSimilarNodes(self):
        dummy_sim_matrix_1 = np.array([
            [0., 1., 1., 1.],
            [0., 0., 1., 1.],
            [0., 0., 0., 1.],
            [0., 0., 0., 0.]])
        dummy_sim_matrix_2 = np.array([
            [0., 1., 1., 1.],
            [0., 0., 0., 1.],
            [0., 0., 0., 0.],
            [0., 0., 0., 0.]])
        dummy_sim_matrix_3 = np.array([
            [0., 1., 0., 0.],
            [0., 0., 1., 0.],
            [0., 0., 0., 1.],
            [0., 0., 0., 0.]])
        cols_nodes_map = {0: "a", 1: "b", 2: "c", 3: "d"}
        
        # TODO: is this way of similar nodes extraction good?
        similar_nodes_1_exp = [["a", "b", "c", "d"], ["b", "c", "d"], ["c", "d"]]
        similar_nodes_2_exp = [["a", "b", "c", "d"], ["b", "d"]]
        similar_nodes_3_exp = [["a", "b"], ["b", "c"], ["c", "d"]]
        
        similar_nodes_1 = similar_nodes_mining.get_similar_nodes(dummy_sim_matrix_1, cols_nodes_map)
        similar_nodes_2 = similar_nodes_mining.get_similar_nodes(dummy_sim_matrix_2, cols_nodes_map)
        similar_nodes_3 = similar_nodes_mining.get_similar_nodes(dummy_sim_matrix_3, cols_nodes_map)
        self.assertEqual(similar_nodes_1_exp, similar_nodes_1, "Wrong similar nodes were extracted.")
        self.assertEqual(similar_nodes_2_exp, similar_nodes_2, "Wrong similar nodes were extracted.")
        self.assertEqual(similar_nodes_3_exp, similar_nodes_3, "Wrong similar nodes were extracted.")

if __name__ == "__main__":
    #import sys;sys.argv = ['', 'Test.testFeatureExtraction']
    unittest.main()